<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>momentGW package &#8212; momentGW  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="momentgw-package">
<h1>momentGW package<a class="headerlink" href="#momentgw-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="momentGW.pbc.html">momentGW.pbc package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.uhf.html">momentGW.pbc.uhf package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.base">momentGW.pbc.uhf.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.evgw">momentGW.pbc.uhf.evgw module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.fock">momentGW.pbc.uhf.fock module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.fsgw">momentGW.pbc.uhf.fsgw module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.gw">momentGW.pbc.uhf.gw module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.ints">momentGW.pbc.uhf.ints module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.qsgw">momentGW.pbc.uhf.qsgw module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.scgw">momentGW.pbc.uhf.scgw module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf.tda">momentGW.pbc.uhf.tda module</a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.uhf.html#module-momentGW.pbc.uhf">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.base">momentGW.pbc.base module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW"><code class="docutils literal notranslate"><span class="pre">BaseKGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.cell"><code class="docutils literal notranslate"><span class="pre">BaseKGW.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.compression"><code class="docutils literal notranslate"><span class="pre">BaseKGW.compression</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.fc"><code class="docutils literal notranslate"><span class="pre">BaseKGW.fc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.get_nmo"><code class="docutils literal notranslate"><span class="pre">BaseKGW.get_nmo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.get_nocc"><code class="docutils literal notranslate"><span class="pre">BaseKGW.get_nocc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.kpts"><code class="docutils literal notranslate"><span class="pre">BaseKGW.kpts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.mol"><code class="docutils literal notranslate"><span class="pre">BaseKGW.mol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.nkpts"><code class="docutils literal notranslate"><span class="pre">BaseKGW.nkpts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.base.BaseKGW.nmo"><code class="docutils literal notranslate"><span class="pre">BaseKGW.nmo</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.evgw">momentGW.pbc.evgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.evgw.evKGW"><code class="docutils literal notranslate"><span class="pre">evKGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.evgw.evKGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">evKGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.evgw.evKGW.name"><code class="docutils literal notranslate"><span class="pre">evKGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.evgw.evKGW.remove_unphysical_poles"><code class="docutils literal notranslate"><span class="pre">evKGW.remove_unphysical_poles()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.fock">momentGW.pbc.fock module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop"><code class="docutils literal notranslate"><span class="pre">FockLoop</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.auxiliary_shift"><code class="docutils literal notranslate"><span class="pre">FockLoop.auxiliary_shift()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.kernel"><code class="docutils literal notranslate"><span class="pre">FockLoop.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.kpts"><code class="docutils literal notranslate"><span class="pre">FockLoop.kpts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.naux"><code class="docutils literal notranslate"><span class="pre">FockLoop.naux</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.nqmo"><code class="docutils literal notranslate"><span class="pre">FockLoop.nqmo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.search_chempot"><code class="docutils literal notranslate"><span class="pre">FockLoop.search_chempot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.FockLoop.solve_dyson"><code class="docutils literal notranslate"><span class="pre">FockLoop.solve_dyson()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.minimize_chempot"><code class="docutils literal notranslate"><span class="pre">minimize_chempot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.search_chempot"><code class="docutils literal notranslate"><span class="pre">search_chempot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.search_chempot_constrained"><code class="docutils literal notranslate"><span class="pre">search_chempot_constrained()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fock.search_chempot_unconstrained"><code class="docutils literal notranslate"><span class="pre">search_chempot_unconstrained()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.fsgw">momentGW.pbc.fsgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fsgw.fsKGW"><code class="docutils literal notranslate"><span class="pre">fsKGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fsgw.fsKGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">fsKGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fsgw.fsKGW.name"><code class="docutils literal notranslate"><span class="pre">fsKGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fsgw.fsKGW.project_basis"><code class="docutils literal notranslate"><span class="pre">fsKGW.project_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fsgw.fsKGW.self_energy_to_moments"><code class="docutils literal notranslate"><span class="pre">fsKGW.self_energy_to_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.fsgw.fsKGW.solver"><code class="docutils literal notranslate"><span class="pre">fsKGW.solver</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.gw">momentGW.pbc.gw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW"><code class="docutils literal notranslate"><span class="pre">KGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.ao2mo"><code class="docutils literal notranslate"><span class="pre">KGW.ao2mo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.build_se_moments"><code class="docutils literal notranslate"><span class="pre">KGW.build_se_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.build_se_static"><code class="docutils literal notranslate"><span class="pre">KGW.build_se_static()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.energy_gm"><code class="docutils literal notranslate"><span class="pre">KGW.energy_gm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.energy_hf"><code class="docutils literal notranslate"><span class="pre">KGW.energy_hf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.init_gf"><code class="docutils literal notranslate"><span class="pre">KGW.init_gf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.interpolate"><code class="docutils literal notranslate"><span class="pre">KGW.interpolate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.kernel"><code class="docutils literal notranslate"><span class="pre">KGW.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.make_rdm1"><code class="docutils literal notranslate"><span class="pre">KGW.make_rdm1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.name"><code class="docutils literal notranslate"><span class="pre">KGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.gw.KGW.solve_dyson"><code class="docutils literal notranslate"><span class="pre">KGW.solve_dyson()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.ints">momentGW.pbc.ints module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals"><code class="docutils literal notranslate"><span class="pre">KIntegrals</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.Lai"><code class="docutils literal notranslate"><span class="pre">KIntegrals.Lai</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_cderi_from_thc"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_cderi_from_thc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_compression_metric"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_compression_metric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_ewald"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_ewald()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_fock"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_fock()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_j"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_j()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_jk"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_jk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_k"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.get_veff"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_veff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.madelung"><code class="docutils literal notranslate"><span class="pre">KIntegrals.madelung</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.naux"><code class="docutils literal notranslate"><span class="pre">KIntegrals.naux</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.naux_full"><code class="docutils literal notranslate"><span class="pre">KIntegrals.naux_full</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nmo"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nmo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nmo_g"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nmo_g</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nmo_w"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nmo_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nocc"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nocc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nocc_w"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nocc_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nvir"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nvir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.nvir_w"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nvir_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.transform"><code class="docutils literal notranslate"><span class="pre">KIntegrals.transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.ints.KIntegrals.update_coeffs"><code class="docutils literal notranslate"><span class="pre">KIntegrals.update_coeffs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.kpts">momentGW.pbc.kpts module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints"><code class="docutils literal notranslate"><span class="pre">KPoints</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.T"><code class="docutils literal notranslate"><span class="pre">KPoints.T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.conserve"><code class="docutils literal notranslate"><span class="pre">KPoints.conserve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.get_abs_kpts"><code class="docutils literal notranslate"><span class="pre">KPoints.get_abs_kpts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.get_scaled_kpts"><code class="docutils literal notranslate"><span class="pre">KPoints.get_scaled_kpts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.hash_kpts"><code class="docutils literal notranslate"><span class="pre">KPoints.hash_kpts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.index"><code class="docutils literal notranslate"><span class="pre">KPoints.index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.interpolate"><code class="docutils literal notranslate"><span class="pre">KPoints.interpolate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.is_zero"><code class="docutils literal notranslate"><span class="pre">KPoints.is_zero()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.kmesh"><code class="docutils literal notranslate"><span class="pre">KPoints.kmesh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.loop"><code class="docutils literal notranslate"><span class="pre">KPoints.loop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.loop_size"><code class="docutils literal notranslate"><span class="pre">KPoints.loop_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.member"><code class="docutils literal notranslate"><span class="pre">KPoints.member()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.tol_decimals"><code class="docutils literal notranslate"><span class="pre">KPoints.tol_decimals</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.translation_vectors"><code class="docutils literal notranslate"><span class="pre">KPoints.translation_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.KPoints.wrap_around"><code class="docutils literal notranslate"><span class="pre">KPoints.wrap_around()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.kpts.allow_single_kpt"><code class="docutils literal notranslate"><span class="pre">allow_single_kpt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.qsgw">momentGW.pbc.qsgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW"><code class="docutils literal notranslate"><span class="pre">qsKGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW.build_static_potential"><code class="docutils literal notranslate"><span class="pre">qsKGW.build_static_potential()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">qsKGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW.name"><code class="docutils literal notranslate"><span class="pre">qsKGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW.project_basis"><code class="docutils literal notranslate"><span class="pre">qsKGW.project_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW.self_energy_to_moments"><code class="docutils literal notranslate"><span class="pre">qsKGW.self_energy_to_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.qsgw.qsKGW.solver"><code class="docutils literal notranslate"><span class="pre">qsKGW.solver</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.rpa">momentGW.pbc.rpa module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA"><code class="docutils literal notranslate"><span class="pre">dRPA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.build_dd_moments"><code class="docutils literal notranslate"><span class="pre">dRPA.build_dd_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.eval_diag_main_integral"><code class="docutils literal notranslate"><span class="pre">dRPA.eval_diag_main_integral()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.eval_diag_offset_integral"><code class="docutils literal notranslate"><span class="pre">dRPA.eval_diag_offset_integral()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.eval_main_integral"><code class="docutils literal notranslate"><span class="pre">dRPA.eval_main_integral()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.eval_offset_integral"><code class="docutils literal notranslate"><span class="pre">dRPA.eval_offset_integral()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.integrate"><code class="docutils literal notranslate"><span class="pre">dRPA.integrate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.optimise_main_quad"><code class="docutils literal notranslate"><span class="pre">dRPA.optimise_main_quad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.rpa.dRPA.optimise_offset_quad"><code class="docutils literal notranslate"><span class="pre">dRPA.optimise_offset_quad()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.scgw">momentGW.pbc.scgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.scgw.scKGW"><code class="docutils literal notranslate"><span class="pre">scKGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.scgw.scKGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">scKGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.scgw.scKGW.name"><code class="docutils literal notranslate"><span class="pre">scKGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.scgw.scKGW.remove_unphysical_poles"><code class="docutils literal notranslate"><span class="pre">scKGW.remove_unphysical_poles()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.tda">momentGW.pbc.tda module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA"><code class="docutils literal notranslate"><span class="pre">dTDA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.build_dd_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_dd_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.build_se_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_se_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.convolve"><code class="docutils literal notranslate"><span class="pre">dTDA.convolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.kernel"><code class="docutils literal notranslate"><span class="pre">dTDA.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.kpts"><code class="docutils literal notranslate"><span class="pre">dTDA.kpts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.nkpts"><code class="docutils literal notranslate"><span class="pre">dTDA.nkpts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.tda.dTDA.nov"><code class="docutils literal notranslate"><span class="pre">dTDA.nov</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc.thc">momentGW.pbc.thc module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals"><code class="docutils literal notranslate"><span class="pre">KIntegrals</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals.get_j"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_j()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals.get_k"><code class="docutils literal notranslate"><span class="pre">KIntegrals.get_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals.import_thc_components"><code class="docutils literal notranslate"><span class="pre">KIntegrals.import_thc_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals.naux"><code class="docutils literal notranslate"><span class="pre">KIntegrals.naux</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals.nkpts"><code class="docutils literal notranslate"><span class="pre">KIntegrals.nkpts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.KIntegrals.transform"><code class="docutils literal notranslate"><span class="pre">KIntegrals.transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.dTDA"><code class="docutils literal notranslate"><span class="pre">dTDA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.dTDA.build_dd_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_dd_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.pbc.html#momentGW.pbc.thc.dTDA.build_se_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_se_moments()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.pbc.html#module-momentGW.pbc">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="momentGW.uhf.html">momentGW.uhf package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.base">momentGW.uhf.base module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.base.BaseUGW"><code class="docutils literal notranslate"><span class="pre">BaseUGW</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.evgw">momentGW.uhf.evgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.evgw.evUGW"><code class="docutils literal notranslate"><span class="pre">evUGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.evgw.evUGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">evUGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.evgw.evUGW.name"><code class="docutils literal notranslate"><span class="pre">evUGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.evgw.evUGW.remove_unphysical_poles"><code class="docutils literal notranslate"><span class="pre">evUGW.remove_unphysical_poles()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.fock">momentGW.uhf.fock module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop"><code class="docutils literal notranslate"><span class="pre">FockLoop</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.auxiliary_shift"><code class="docutils literal notranslate"><span class="pre">FockLoop.auxiliary_shift()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.kernel"><code class="docutils literal notranslate"><span class="pre">FockLoop.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.naux"><code class="docutils literal notranslate"><span class="pre">FockLoop.naux</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.nelec"><code class="docutils literal notranslate"><span class="pre">FockLoop.nelec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.nqmo"><code class="docutils literal notranslate"><span class="pre">FockLoop.nqmo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.search_chempot"><code class="docutils literal notranslate"><span class="pre">FockLoop.search_chempot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fock.FockLoop.solve_dyson"><code class="docutils literal notranslate"><span class="pre">FockLoop.solve_dyson()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.fsgw">momentGW.uhf.fsgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fsgw.fsUGW"><code class="docutils literal notranslate"><span class="pre">fsUGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fsgw.fsUGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">fsUGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fsgw.fsUGW.name"><code class="docutils literal notranslate"><span class="pre">fsUGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fsgw.fsUGW.project_basis"><code class="docutils literal notranslate"><span class="pre">fsUGW.project_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fsgw.fsUGW.self_energy_to_moments"><code class="docutils literal notranslate"><span class="pre">fsUGW.self_energy_to_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.fsgw.fsUGW.solver"><code class="docutils literal notranslate"><span class="pre">fsUGW.solver</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.gw">momentGW.uhf.gw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW"><code class="docutils literal notranslate"><span class="pre">UGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.ao2mo"><code class="docutils literal notranslate"><span class="pre">UGW.ao2mo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.build_se_moments"><code class="docutils literal notranslate"><span class="pre">UGW.build_se_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.build_se_static"><code class="docutils literal notranslate"><span class="pre">UGW.build_se_static()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.energy_gm"><code class="docutils literal notranslate"><span class="pre">UGW.energy_gm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.energy_hf"><code class="docutils literal notranslate"><span class="pre">UGW.energy_hf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.init_gf"><code class="docutils literal notranslate"><span class="pre">UGW.init_gf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.kernel"><code class="docutils literal notranslate"><span class="pre">UGW.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.make_rdm1"><code class="docutils literal notranslate"><span class="pre">UGW.make_rdm1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.name"><code class="docutils literal notranslate"><span class="pre">UGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.gw.UGW.solve_dyson"><code class="docutils literal notranslate"><span class="pre">UGW.solve_dyson()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.ints">momentGW.uhf.ints module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals"><code class="docutils literal notranslate"><span class="pre">UIntegrals</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.Lia"><code class="docutils literal notranslate"><span class="pre">UIntegrals.Lia</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.Lpq"><code class="docutils literal notranslate"><span class="pre">UIntegrals.Lpq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.Lpx"><code class="docutils literal notranslate"><span class="pre">UIntegrals.Lpx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.dtype"><code class="docutils literal notranslate"><span class="pre">UIntegrals.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.get_compression_metric"><code class="docutils literal notranslate"><span class="pre">UIntegrals.get_compression_metric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.get_fock"><code class="docutils literal notranslate"><span class="pre">UIntegrals.get_fock()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.get_j"><code class="docutils literal notranslate"><span class="pre">UIntegrals.get_j()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.get_jk"><code class="docutils literal notranslate"><span class="pre">UIntegrals.get_jk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.get_k"><code class="docutils literal notranslate"><span class="pre">UIntegrals.get_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.get_veff"><code class="docutils literal notranslate"><span class="pre">UIntegrals.get_veff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.is_bare"><code class="docutils literal notranslate"><span class="pre">UIntegrals.is_bare</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.mo_coeff_g"><code class="docutils literal notranslate"><span class="pre">UIntegrals.mo_coeff_g</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.mo_coeff_w"><code class="docutils literal notranslate"><span class="pre">UIntegrals.mo_coeff_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.mo_occ_w"><code class="docutils literal notranslate"><span class="pre">UIntegrals.mo_occ_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.naux"><code class="docutils literal notranslate"><span class="pre">UIntegrals.naux</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.naux_full"><code class="docutils literal notranslate"><span class="pre">UIntegrals.naux_full</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nmo"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nmo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nmo_g"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nmo_g</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nmo_w"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nmo_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nocc"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nocc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nocc_w"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nocc_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nvir"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nvir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.nvir_w"><code class="docutils literal notranslate"><span class="pre">UIntegrals.nvir_w</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.transform"><code class="docutils literal notranslate"><span class="pre">UIntegrals.transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.ints.UIntegrals.update_coeffs"><code class="docutils literal notranslate"><span class="pre">UIntegrals.update_coeffs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.qsgw">momentGW.uhf.qsgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW"><code class="docutils literal notranslate"><span class="pre">qsUGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW.build_static_potential"><code class="docutils literal notranslate"><span class="pre">qsUGW.build_static_potential()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">qsUGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW.name"><code class="docutils literal notranslate"><span class="pre">qsUGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW.project_basis"><code class="docutils literal notranslate"><span class="pre">qsUGW.project_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW.self_energy_to_moments"><code class="docutils literal notranslate"><span class="pre">qsUGW.self_energy_to_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.qsgw.qsUGW.solver"><code class="docutils literal notranslate"><span class="pre">qsUGW.solver</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.rpa">momentGW.uhf.rpa module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.rpa.dRPA"><code class="docutils literal notranslate"><span class="pre">dRPA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.rpa.dRPA.build_dd_moments"><code class="docutils literal notranslate"><span class="pre">dRPA.build_dd_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.rpa.dRPA.build_dd_moments_exact"><code class="docutils literal notranslate"><span class="pre">dRPA.build_dd_moments_exact()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.rpa.dRPA.integrate"><code class="docutils literal notranslate"><span class="pre">dRPA.integrate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.scgw">momentGW.uhf.scgw module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.scgw.scUGW"><code class="docutils literal notranslate"><span class="pre">scUGW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.scgw.scUGW.check_convergence"><code class="docutils literal notranslate"><span class="pre">scUGW.check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.scgw.scUGW.name"><code class="docutils literal notranslate"><span class="pre">scUGW.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.scgw.scUGW.remove_unphysical_poles"><code class="docutils literal notranslate"><span class="pre">scUGW.remove_unphysical_poles()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf.tda">momentGW.uhf.tda module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA"><code class="docutils literal notranslate"><span class="pre">dTDA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.build_dd_moment_inv"><code class="docutils literal notranslate"><span class="pre">dTDA.build_dd_moment_inv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.build_dd_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_dd_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.build_dp_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_dp_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.build_se_moments"><code class="docutils literal notranslate"><span class="pre">dTDA.build_se_moments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.convolve"><code class="docutils literal notranslate"><span class="pre">dTDA.convolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.kernel"><code class="docutils literal notranslate"><span class="pre">dTDA.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="momentGW.uhf.html#momentGW.uhf.tda.dTDA.nov"><code class="docutils literal notranslate"><span class="pre">dTDA.nov</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="momentGW.uhf.html#module-momentGW.uhf">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-momentGW.base">
<span id="momentgw-base-module"></span><h2>momentGW.base module<a class="headerlink" href="#module-momentGW.base" title="Link to this heading">¶</a></h2>
<p>Base classes for moment-constrained GW solvers.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.base.Base">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.base.</span></span><span class="sig-name descname"><span class="pre">Base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.Base" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class.</p>
<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.active">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">active</span></span><a class="headerlink" href="#momentGW.base.Base.active" title="Link to this definition">¶</a></dt>
<dd><p>Get the mask to remove frozen orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.Base.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.Base.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method for the kernel driver function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#momentGW.base.Base.mo_coeff" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecular orbital coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mo_coeff_with_frozen">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_with_frozen</span></span><a class="headerlink" href="#momentGW.base.Base.mo_coeff_with_frozen" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecular orbital coefficients with frozen orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#momentGW.base.Base.mo_energy" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecular orbital energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mo_energy_with_frozen">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_with_frozen</span></span><a class="headerlink" href="#momentGW.base.Base.mo_energy_with_frozen" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecular orbital energies with frozen orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#momentGW.base.Base.mo_occ" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecular orbital occupation numbers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mo_occ_with_frozen">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ_with_frozen</span></span><a class="headerlink" href="#momentGW.base.Base.mo_occ_with_frozen" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecular orbital occupation numbers with frozen
orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#momentGW.base.Base.mol" title="Link to this definition">¶</a></dt>
<dd><p>Get the molecule object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.nao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#momentGW.base.Base.nao" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of atomic orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#momentGW.base.Base.nmo" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of molecular orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#momentGW.base.Base.nocc" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of occupied molecular orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.Base.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.Base.run" title="Link to this definition">¶</a></dt>
<dd><p>Alias for <cite>kernel</cite>, instead returning <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>tuple</em>) – Positional arguments to pass to <cite>kernel</cite>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Keyword arguments to pass to <cite>kernel</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The solver object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW">BaseGW</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.Base.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#momentGW.base.Base.with_df" title="Link to this definition">¶</a></dt>
<dd><p>Get the density fitting object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.base.BaseGW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.base.</span></span><span class="sig-name descname"><span class="pre">BaseGW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.BaseGW" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.base.Base" title="momentGW.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Base class for moment-constrained GW solvers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>diagonal_se</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use a diagonal approximation in the self-energy.
Default value is <cite>False</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of numerical integration points. Default value is <cite>48</cite>.</p></li>
<li><p><strong>optimise_chempot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, optimise the chemical potential by shifting the
position of the poles in the self-energy relative to those in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>fock_loop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, self-consistently renormalise the density matrix
according to the updated Green’s function. Default value is
<cite>False</cite>.</p></li>
<li><p><strong>fock_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options passed to the Fock loop. For more details
see <cite>momentGW.fock</cite>.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Blocks of the ERIs to use as a metric for compression. Can be
one or more of <cite>(“oo”, “ov”, “vv”, “ia”)</cite> which can be passed as
a comma-separated string. <cite>“oo”</cite>, <cite>“ov”</cite> and <cite>“vv”</cite> refer to
compression on the initial ERIs, whereas <cite>“ia”</cite> refers to
compression on the ERIs entering RPA, which may change under a
self-consistent scheme. Default value is <cite>“ia”</cite>.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the compression. Default value is <cite>1e-10</cite>.</p></li>
<li><p><strong>thc_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options to be used for THC calculations. Current
implementation requires a filepath to import the THC integrals.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.BaseGW.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method for getting the integrals object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.build_se_moments">
<span class="sig-name descname"><span class="pre">build_se_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.BaseGW.build_se_moments" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method for building the self-energy moments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.build_se_static">
<span class="sig-name descname"><span class="pre">build_se_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.BaseGW.build_se_static" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method for building the static self-energy.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.compression">
<span class="sig-name descname"><span class="pre">compression</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ia'</span></em><a class="headerlink" href="#momentGW.base.BaseGW.compression" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.compression_tol">
<span class="sig-name descname"><span class="pre">compression_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-10</span></em><a class="headerlink" href="#momentGW.base.BaseGW.compression_tol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.diagonal_se">
<span class="sig-name descname"><span class="pre">diagonal_se</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#momentGW.base.BaseGW.diagonal_se" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.fock_loop">
<span class="sig-name descname"><span class="pre">fock_loop</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#momentGW.base.BaseGW.fock_loop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.fock_opts">
<span class="sig-name descname"><span class="pre">fock_opts</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'conv_tol_nelec':</span> <span class="pre">1e-06,</span> <span class="pre">'conv_tol_rdm1':</span> <span class="pre">1e-08,</span> <span class="pre">'fock_diis_min_space':</span> <span class="pre">1,</span> <span class="pre">'fock_diis_space':</span> <span class="pre">10,</span> <span class="pre">'max_cycle_inner':</span> <span class="pre">50,</span> <span class="pre">'max_cycle_outer':</span> <span class="pre">20}</span></em><a class="headerlink" href="#momentGW.base.BaseGW.fock_opts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.has_fock_loop">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_fock_loop</span></span><a class="headerlink" href="#momentGW.base.BaseGW.has_fock_loop" title="Link to this definition">¶</a></dt>
<dd><p>Get a boolean indicating whether the solver requires a Fock
loop.</p>
<p class="rubric">Notes</p>
<p>For most GW methods, this is simply <cite>self.fock_loop</cite>. In some
methods such as qsGW, a Fock loop is required with or without
<cite>self.fock_loop</cite> for the quasiparticle self-consistency, with
this property acting as a hook to indicate this.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.BaseGW.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Driver for the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used instead of calculating them. Default value is
<cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>converged</strong> (<em>bool</em>) – Whether the solver converged. For single-shot calculations,
this is always <cite>True</cite>.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>numpy.ndarray</em>) – Quasiparticle energies. For most GW methods, this is <cite>None</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.base.BaseGW.name" title="Link to this definition">¶</a></dt>
<dd><p>Abstract property for the solver name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.npoints">
<span class="sig-name descname"><span class="pre">npoints</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">48</span></em><a class="headerlink" href="#momentGW.base.BaseGW.npoints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.optimise_chempot">
<span class="sig-name descname"><span class="pre">optimise_chempot</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#momentGW.base.BaseGW.optimise_chempot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.polarizability">
<span class="sig-name descname"><span class="pre">polarizability</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'drpa'</span></em><a class="headerlink" href="#momentGW.base.BaseGW.polarizability" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.qp_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qp_energy</span></span><a class="headerlink" href="#momentGW.base.BaseGW.qp_energy" title="Link to this definition">¶</a></dt>
<dd><p>Get the quasiparticle energies.</p>
<p class="rubric">Notes</p>
<p>For most GW methods, this simply consists of the poles of the
<cite>self.gf</cite> that best overlap with the MOs, in order. In some
methods such as qsGW, these two quantities are not the same.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.solve_dyson">
<span class="sig-name descname"><span class="pre">solve_dyson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.base.BaseGW.solve_dyson" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method for solving the Dyson equation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.base.BaseGW.thc_opts">
<span class="sig-name descname"><span class="pre">thc_opts</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'file_path':</span> <span class="pre">None}</span></em><a class="headerlink" href="#momentGW.base.BaseGW.thc_opts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-momentGW.bse">
<span id="momentgw-bse-module"></span><h2>momentGW.bse module<a class="headerlink" href="#module-momentGW.bse" title="Link to this heading">¶</a></h2>
<p>Spin-restricted Bethe-Salpeter equation (BSE) via self-energy moment
constraints for molecular systems.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.bse.BSE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.bse.</span></span><span class="sig-name descname"><span class="pre">BSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.base.Base" title="momentGW.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Bethe-Salpeter equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em>) – Type of polarizability to use, can be one of <a href="#id1"><span class="problematic" id="id2">`</span></a>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is the same
as the underling GW object.</p></li>
<li><p><strong>excitation</strong> (<em>str</em>) – Type of excitation, can be one of <cite>(“singlet”, “triplet”)</cite>.
Default value is <cite>“singlet”</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.BSE.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Get the integrals object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transform</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to transform the integrals object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>integrals</strong> – Integrals object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals">BaseIntegrals</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.BSE.build_dd_moment_inv">
<span class="sig-name descname"><span class="pre">build_dd_moment_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE.build_dd_moment_inv" title="Link to this definition">¶</a></dt>
<dd><p>Build the first inverse moment of the density-density response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments to pass to the RPA or TDA
solver. See <cite>momentGW.tda</cite> and <cite>momentGW.rpa</cite> for options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moment</strong> – First inverse (<cite>n=-1</cite>) moment of the density-density
response.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.BSE.build_dp_moments">
<span class="sig-name descname"><span class="pre">build_dp_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE.build_dp_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the dynamic polarizability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>matvec</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that computes the matrix-vector product between
the Bethe-Salpeter Hamiltonian and a vector. If not
provided, calculate using <cite>build_matvec</cite>. Default value is
<cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments_dp</strong> (<em>numpy.ndarray</em>) – Moments of the dynamic polarizability.</p></li>
<li><p><strong>orth</strong> (<em>numpy.ndarray</em>) – Orthogonalization matrix. For compatibility with the
Chebyshev solver, and is <cite>None</cite> in this case.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.BSE.build_matvec">
<span class="sig-name descname"><span class="pre">build_matvec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE.build_matvec" title="Link to this definition">¶</a></dt>
<dd><p>Build the matrix-vector product required for the
Bethe-Salpeter equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>moment</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – First inverse (<cite>n=-1</cite>) moment of the density-density
response. If not provided, calculate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>matvec</strong> – Function that takes a vector <code class="docutils literal notranslate"><span class="pre">x</span></code> and returns the matrix-
vector product <code class="docutils literal notranslate"><span class="pre">xA</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.bse.BSE.excitation">
<span class="sig-name descname"><span class="pre">excitation</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'singlet'</span></em><a class="headerlink" href="#momentGW.bse.BSE.excitation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.BSE.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Driver for the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Chebyshev moments of the dynamic polarizability, if passed
then they will be used instead of calculating them. Default
value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gf</strong> – Green’s function object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.bse.BSE.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.bse.BSE.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.bse.BSE.polarizability">
<span class="sig-name descname"><span class="pre">polarizability</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#momentGW.bse.BSE.polarizability" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.BSE.solve_bse">
<span class="sig-name descname"><span class="pre">solve_bse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.BSE.solve_bse" title="Link to this definition">¶</a></dt>
<dd><p>Solve the Bethe-Salpeter equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> (<em>numpy.ndarray</em>) – Moments of the dynamic polarizability.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gf</strong> – Green’s function object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.bse.</span></span><span class="sig-name descname"><span class="pre">cpBSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.cpBSE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.bse.BSE" title="momentGW.bse.BSE"><code class="xref py py-class docutils literal notranslate"><span class="pre">BSE</span></code></a></p>
<p>Chebyshev-polynomial Bethe-Salpeter equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>scale</strong> (<em>tuple</em><em> of </em><em>int</em>) – <p>Scaling parameters used to scale the spectrum to <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">1]</span></code>,
given as <cite>(a, b)</cite> where</p>
<div class="math notranslate nohighlight">
\[\begin{split}a = \\frac{\omega_{\max} - \omega_{\min}}{2 - \epsilon},
b = \\frac{\omega_{\max} + \omega_{\min}}{2}.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_{\max}\)</span> and <span class="math notranslate nohighlight">\(\omega_{\min}\)</span> are the
maximum and minimum energies in the spectrum, respectively, and
<span class="math notranslate nohighlight">\(\epsilon\)</span> is a small number shifting the spectrum values
away from the boundaries.</p>
</p></li>
<li><p><strong>grid</strong> (<em>numpy.ndarray</em>) – Grid to plot spectral function on.</p></li>
<li><p><strong>eta</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularisation parameter. Default value is <cite>0.1</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>excitation</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of excitation, can be one of <cite>(“singlet”, “triplet”)</cite>.
Default value is <cite>“singlet”</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE.build_dp_moments">
<span class="sig-name descname"><span class="pre">build_dp_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.cpBSE.build_dp_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the dynamic polarizability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>matvec</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that computes the matrix-vector product between
the Bethe-Salpeter Hamiltonian and a vector. If not
provided, calculate using <cite>build_matvec</cite>. Default value is
<cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moments_dp</strong> – Chebyshev moments of the dynamic polarizability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE.eta">
<span class="sig-name descname"><span class="pre">eta</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#momentGW.bse.cpBSE.eta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#momentGW.bse.cpBSE.grid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.bse.cpBSE.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#momentGW.bse.cpBSE.scale" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.bse.cpBSE.solve_bse">
<span class="sig-name descname"><span class="pre">solve_bse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.cpBSE.solve_bse" title="Link to this definition">¶</a></dt>
<dd><p>Solve the Bethe-Salpeter equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> (<em>numpy.ndarray</em>) – Chebyshev moments of the dynamic polarizability.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gf</strong> – Green’s function object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.bse.kernel">
<span class="sig-prename descclassname"><span class="pre">momentGW.bse.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.bse.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Bethe-Salpeter equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Moments of the dynamic polarizability, if passed then they will
be used instead of calculating them. Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gf</strong> – Green’s function object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW.energy">
<span id="momentgw-energy-module"></span><h2>momentGW.energy module<a class="headerlink" href="#module-momentGW.energy" title="Link to this heading">¶</a></h2>
<p>Energy functionals.</p>
<dl class="py function">
<dt class="sig sig-object py" id="momentGW.energy.galitskii_migdal">
<span class="sig-prename descclassname"><span class="pre">momentGW.energy.</span></span><span class="sig-name descname"><span class="pre">galitskii_migdal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.energy.galitskii_migdal" title="Link to this definition">¶</a></dt>
<dd><p>Galitskii–Migdal energy functional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>flip</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default option is to use the occupied Green’s function and the
virtual self-energy. If <cite>flip=True</cite>, the virtual Green’s
function and the occupied self-energy are used instead. Default
value is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_2b</strong> – Galitskii–Migdal energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This functional is the analytically integrated version of <a href="#id17"><span class="problematic" id="id3">[1]_</span></a></p>
<div class="math notranslate nohighlight">
\[\frac{\pi}{4} \int d\omega \mathrm{Tr}[G(i\omega)
\Sigma(i\omega)]\]</div>
<p>in terms of the poles of the Green’s function and the self-energy.
This scales as <span class="math notranslate nohighlight">\(\mathcal{O}(N^4)\)</span> with system size <a href="#id18"><span class="problematic" id="id4">[2]_</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>V. M. Galitskii and A. B. Migdal, Sov. Phys. JETP 7, 96,
1958.</p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>O. J. Backhouse, M. Nusspickel, and G. H. Booth, J. Chem.
Theory Comput. 16, 2, 2020.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.energy.galitskii_migdal_g0">
<span class="sig-prename descclassname"><span class="pre">momentGW.energy.</span></span><span class="sig-name descname"><span class="pre">galitskii_migdal_g0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.energy.galitskii_migdal_g0" title="Link to this definition">¶</a></dt>
<dd><p>Galitskii–Migdal energy functional for the non-interacting Green’s
function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em>) – MO energies (poles of the Green’s function).</p></li>
<li><p><strong>mo_occ</strong> (<em>numpy.ndarray</em>) – MO occupancies.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy.</p></li>
<li><p><strong>flip</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default option is to use the occupied Green’s function and the
virtual self-energy. If <cite>flip=True</cite>, the virtual Green’s
function and the occupied self-energy are used instead. Default
value is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_2b</strong> – Galitskii–Migdal energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This functional is the analytically integrated version of <a href="#id19"><span class="problematic" id="id7">[1]_</span></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\pi}{4} \int d\omega \\
    \mathrm{Tr}[G_{0}(i\omega) \Sigma(i\omega)]\end{split}\]</div>
<p>in terms of the poles of the mean-field Green’s function and the
self-energy. This scales as <span class="math notranslate nohighlight">\(\mathcal{O}(N^3)\)</span> with system
size <a href="#id20"><span class="problematic" id="id8">[2]_</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>V. M. Galitskii and A. B. Migdal, Sov. Phys. JETP 7, 96,
1958.</p>
</aside>
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>O. J. Backhouse, M. Nusspickel, and G. H. Booth, J. Chem.
Theory Comput. 16, 2, 2020.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.energy.hartree_fock">
<span class="sig-prename descclassname"><span class="pre">momentGW.energy.</span></span><span class="sig-name descname"><span class="pre">hartree_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.energy.hartree_fock" title="Link to this definition">¶</a></dt>
<dd><p>Hartree–Fock energy functional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>numpy.ndarray</em>) – One-particle reduced density matrix.</p></li>
<li><p><strong>fock</strong> (<em>numpy.ndarray</em>) – Fock matrix.</p></li>
<li><p><strong>h1e</strong> (<em>numpy.ndarray</em>) – One-electron Hamiltonian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_1b</strong> – Hartree–Fock energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW.evgw">
<span id="momentgw-evgw-module"></span><h2>momentGW.evgw module<a class="headerlink" href="#module-momentGW.evgw" title="Link to this heading">¶</a></h2>
<p>Spin-restricted eigenvalue self-consistent GW via self-energy moment
constraints for molecular systems.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.evgw.evGW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.evgw.</span></span><span class="sig-name descname"><span class="pre">evGW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.evgw.evGW" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.gw.GW" title="momentGW.gw.GW"><code class="xref py py-class docutils literal notranslate"><span class="pre">GW</span></code></a></p>
<p>Spin-restricted eigenvalue self-consistent GW via self-energy moment
constraints for molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>diagonal_se</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use a diagonal approximation in the self-energy.
Default value is <cite>False</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of numerical integration points. Default value is <cite>48</cite>.</p></li>
<li><p><strong>optimise_chempot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, optimise the chemical potential by shifting the
position of the poles in the self-energy relative to those in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>fock_loop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, self-consistently renormalise the density matrix
according to the updated Green’s function. Default value is
<cite>False</cite>.</p></li>
<li><p><strong>fock_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options passed to the Fock loop. For more details
see <cite>momentGW.fock</cite>.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Blocks of the ERIs to use as a metric for compression. Can be
one or more of <cite>(“oo”, “ov”, “vv”, “ia”)</cite> which can be passed as
a comma-separated string. <cite>“oo”</cite>, <cite>“ov”</cite> and <cite>“vv”</cite> refer to
compression on the initial ERIs, whereas <cite>“ia”</cite> refers to
compression on the ERIs entering RPA, which may change under a
self-consistent scheme. Default value is <cite>“ia”</cite>.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the compression. Default value is <cite>1e-10</cite>.</p></li>
<li><p><strong>thc_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options to be used for THC calculations. Current
implementation requires a filepath to import the THC integrals.</p></li>
<li><p><strong>g0</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, do not self-consistently update the eigenvalues in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>w0</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, do not self-consistently update the eigenvalues in
the screened Coulomb interaction. Default value is <cite>False</cite>.</p></li>
<li><p><strong>max_cycle</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations. Default value is <cite>50</cite>.</p></li>
<li><p><strong>conv_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the HOMO and LUMO.
Default value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_tol_moms</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the moments. Default
value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_logical</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes an iterable of booleans as input indicating
whether the individual <cite>conv_tol</cite> and <cite>conv_tol_moms</cite> have been
satisfied, respectively, and returns a boolean indicating
overall convergence. For example, the function <cite>all</cite> requires
both metrics to be met, and <cite>any</cite> requires just one. Default
value is <cite>all</cite>.</p></li>
<li><p><strong>diis_space</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the DIIS extrapolation space. Default value is <cite>8</cite>.</p></li>
<li><p><strong>damping</strong> (<em>float</em><em>, </em><em>optional</em>) – Damping parameter. Default value is <cite>0.0</cite>.</p></li>
<li><p><strong>weight_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold in physical weight of Green’s function poles, below
which they are considered zero. Default value is <cite>1e-11</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.check_convergence">
<span class="sig-name descname"><span class="pre">check_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_prev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.evgw.evGW.check_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence, and print a summary of changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies.</p></li>
<li><p><strong>mo_energy_prev</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies from the previous iteration.</p></li>
<li><p><strong>th</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>th_prev</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy from the previous
iteration.</p></li>
<li><p><strong>tp</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
<li><p><strong>tp_prev</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy from the previous iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>conv</strong> – Convergence flag.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.conv_logical">
<span class="sig-name descname"><span class="pre">conv_logical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.evgw.evGW.conv_logical" title="Link to this definition">¶</a></dt>
<dd><p>Return True if bool(x) is True for all values x in the iterable.</p>
<p>If the iterable is empty, return True.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#momentGW.evgw.evGW.conv_tol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.conv_tol_moms">
<span class="sig-name descname"><span class="pre">conv_tol_moms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#momentGW.evgw.evGW.conv_tol_moms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.damping">
<span class="sig-name descname"><span class="pre">damping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#momentGW.evgw.evGW.damping" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.diis_space">
<span class="sig-name descname"><span class="pre">diis_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#momentGW.evgw.evGW.diis_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.g0">
<span class="sig-name descname"><span class="pre">g0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#momentGW.evgw.evGW.g0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.max_cycle">
<span class="sig-name descname"><span class="pre">max_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#momentGW.evgw.evGW.max_cycle" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.evgw.evGW.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.remove_unphysical_poles">
<span class="sig-name descname"><span class="pre">remove_unphysical_poles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.evgw.evGW.remove_unphysical_poles" title="Link to this definition">¶</a></dt>
<dd><p>Remove unphysical poles from the Green’s function to stabilise
iterations, according to the threshold <cite>self.weight_tol</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gf_out</strong> – Green’s function, with potentially fewer poles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.w0">
<span class="sig-name descname"><span class="pre">w0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#momentGW.evgw.evGW.w0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.evgw.evGW.weight_tol">
<span class="sig-name descname"><span class="pre">weight_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-11</span></em><a class="headerlink" href="#momentGW.evgw.evGW.weight_tol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.evgw.kernel">
<span class="sig-prename descclassname"><span class="pre">momentGW.evgw.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.evgw.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Moment-constrained eigenvalue self-consistent GW.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used  as the initial guess instead of calculating them.
Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conv</strong> (<em>bool</em>) – Convergence flag.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>numpy.ndarray</em>) – Quasiparticle energies. Always None for evGW, returned for
compatibility with other evGW methods.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW.fock">
<span id="momentgw-fock-module"></span><h2>momentGW.fock module<a class="headerlink" href="#module-momentGW.fock" title="Link to this heading">¶</a></h2>
<p>Fock matrix self-consistent loop.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.fock.</span></span><span class="sig-name descname"><span class="pre">BaseFockLoop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.BaseFockLoop" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for Fock loops.</p>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.auxiliary_shift">
<span class="sig-name descname"><span class="pre">auxiliary_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.auxiliary_shift" title="Link to this definition">¶</a></dt>
<dd><p>Optimise a shift in the auxiliary energies to best satisfy the
electron number.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.conv_tol_nelec">
<span class="sig-name descname"><span class="pre">conv_tol_nelec</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#momentGW.fock.BaseFockLoop.conv_tol_nelec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.conv_tol_rdm1">
<span class="sig-name descname"><span class="pre">conv_tol_rdm1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#momentGW.fock.BaseFockLoop.conv_tol_rdm1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.fock_diis_min_space">
<span class="sig-name descname"><span class="pre">fock_diis_min_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#momentGW.fock.BaseFockLoop.fock_diis_min_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.fock_diis_space">
<span class="sig-name descname"><span class="pre">fock_diis_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#momentGW.fock.BaseFockLoop.fock_diis_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.get_fock" title="Link to this definition">¶</a></dt>
<dd><p>Get the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>rdm1</strong> (<em>numpy.ndarray</em>) – First-order reduced density matrix.</p></li>
<li><p><strong>h1e</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Core Hamiltonian. If <cite>None</cite>, use <cite>self.h1e</cite>. Default value
is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fock</strong> – Fock matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.h1e">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h1e</span></span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.h1e" title="Link to this definition">¶</a></dt>
<dd><p>Get the core Hamiltonian.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.make_rdm1" title="Link to this definition">¶</a></dt>
<dd><p>Get the first-order reduced density matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gf</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Green’s function object. If <cite>None</cite>, use either <cite>self.gf</cite>, or
the mean-field Green’s function. Default value is <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rdm1</strong> – First-order reduced density matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.max_cycle_inner">
<span class="sig-name descname"><span class="pre">max_cycle_inner</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#momentGW.fock.BaseFockLoop.max_cycle_inner" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.max_cycle_outer">
<span class="sig-name descname"><span class="pre">max_cycle_outer</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">20</span></em><a class="headerlink" href="#momentGW.fock.BaseFockLoop.max_cycle_outer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.mo_coeff" title="Link to this definition">¶</a></dt>
<dd><p>Get the MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.nmo" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.nocc" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of occupied MOs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.search_chempot">
<span class="sig-name descname"><span class="pre">search_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.search_chempot" title="Link to this definition">¶</a></dt>
<dd><p>Search for a chemical potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.BaseFockLoop.solve_dyson">
<span class="sig-name descname"><span class="pre">solve_dyson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.BaseFockLoop.solve_dyson" title="Link to this definition">¶</a></dt>
<dd><p>Solve the Dyson equation for a given Fock matrix.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="momentGW.fock.ChemicalPotentialError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.fock.</span></span><span class="sig-name descname"><span class="pre">ChemicalPotentialError</span></span><a class="headerlink" href="#momentGW.fock.ChemicalPotentialError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></p>
<p>Exception raised when the chemical potential cannot be found.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.fock.</span></span><span class="sig-name descname"><span class="pre">FockLoop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.FockLoop" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.fock.BaseFockLoop" title="momentGW.fock.BaseFockLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFockLoop</span></code></a></p>
<p>Self-consistent loop for the density matrix via the Hartree–Fock
self-consistent field for spin-restricted molecular systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Initial Green’s function object. If <cite>None</cite>, use <cite>gw.init_gf()</cite>.
Default value is <cite>None</cite>.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Initial self-energy object. If passed, use as dynamic part of
the self-energy. If <cite>None</cite>, self-energy is assumed to be static
and fully defined by the Fock matrix. Default value is <cite>None</cite>.</p></li>
<li><p><strong>fock_diis_space</strong> (<em>int</em><em>, </em><em>optional</em>) – DIIS space size for the Fock matrix. Default value is <cite>10</cite>.</p></li>
<li><p><strong>fock_diis_min_space</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum DIIS space size for the Fock matrix. Default value is
<cite>1</cite>.</p></li>
<li><p><strong>conv_tol_nelec</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence tolerance for the number of electrons. Default
value is <cite>1e-6</cite>.</p></li>
<li><p><strong>conv_tol_rdm1</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence tolerance for the density matrix. Default value is
<cite>1e-8</cite>.</p></li>
<li><p><strong>max_cycle_inner</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of inner iterations. Default value is <cite>100</cite>.</p></li>
<li><p><strong>max_cycle_outer</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of outer iterations. Default value is <cite>20</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.auxiliary_shift">
<span class="sig-name descname"><span class="pre">auxiliary_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.FockLoop.auxiliary_shift" title="Link to this definition">¶</a></dt>
<dd><p>Optimise a shift in the auxiliary energies to best satisfy the
electron number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fock</strong> (<em>numpy.ndarray</em>) – Fock matrix.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Self-energy. If <cite>None</cite>, use <cite>self.se</cite>. Default value is
<cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>se</strong> – Self-energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dyson.Lehmann</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If there is no dynamic part of the self-energy (<cite>self.se</cite> is
<cite>None</cite>), this method returns <cite>None</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.FockLoop.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Driver for the Fock loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>converged</strong> (<em>bool</em>) – Whether the loop has converged.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.naux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux</span></span><a class="headerlink" href="#momentGW.fock.FockLoop.naux" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of auxiliary states.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.nelec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelec</span></span><a class="headerlink" href="#momentGW.fock.FockLoop.nelec" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of electrons.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.nqmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nqmo</span></span><a class="headerlink" href="#momentGW.fock.FockLoop.nqmo" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of quasiparticle MOs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.search_chempot">
<span class="sig-name descname"><span class="pre">search_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.FockLoop.search_chempot" title="Link to this definition">¶</a></dt>
<dd><p>Search for a chemical potential for a given Green’s function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gf</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Green’s function. If <cite>None</cite>, use <cite>self.gf</cite>. Default value is
<cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>chempot</strong> (<em>float</em>) – Chemical potential.</p></li>
<li><p><strong>nerr</strong> (<em>float</em>) – Error in the number of electrons.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fock.FockLoop.solve_dyson">
<span class="sig-name descname"><span class="pre">solve_dyson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.FockLoop.solve_dyson" title="Link to this definition">¶</a></dt>
<dd><p>Solve the Dyson equation for a given Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fock</strong> (<em>numpy.ndarray</em>) – Fock matrix.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Self-energy. If <cite>None</cite>, use <cite>self.se</cite>. Default value is
<cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function.</p></li>
<li><p><strong>nerr</strong> (<em>float</em>) – Error in the number of electrons.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If there is no dynamic part of the self-energy (<cite>self.se</cite> is
<cite>None</cite>), this method simply diagonalises the Fock matrix and
returns the Lehmann representation of the resulting zeroth-order
Green’s function.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.fock.minimize_chempot">
<span class="sig-prename descclassname"><span class="pre">momentGW.fock.</span></span><span class="sig-name descname"><span class="pre">minimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.minimize_chempot" title="Link to this definition">¶</a></dt>
<dd><p>Optimise the shift in auxiliary energies to satisfy the electron
number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>fock</strong> (<em>numpy.ndarray</em>) – Fock matrix.</p></li>
<li><p><strong>nelec</strong> (<em>int</em>) – Number of electrons.</p></li>
<li><p><strong>occupancy</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of electrons per state. Default value is <cite>2</cite>.</p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>optional</em>) – Initial guess value. Default value is <cite>0.0</cite>.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold in the number of electrons. Default value is <cite>1e-6</cite>.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations. Default value is <cite>200</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>opt</strong> (<em>scipy.optimize.OptimizeResult</em>) – Result of the optimisation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.fock.search_chempot">
<span class="sig-prename descclassname"><span class="pre">momentGW.fock.</span></span><span class="sig-name descname"><span class="pre">search_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fock.search_chempot" title="Link to this definition">¶</a></dt>
<dd><p>Search for a chemical potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<em>numpy.ndarray</em>) – Eigenvalues.</p></li>
<li><p><strong>v</strong> (<em>numpy.ndarray</em>) – Eigenvectors.</p></li>
<li><p><strong>nphys</strong> (<em>int</em>) – Number of physical states.</p></li>
<li><p><strong>nelec</strong> (<em>int</em>) – Number of electrons.</p></li>
<li><p><strong>occupancy</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of electrons per state. Default value is <cite>2</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>chempot</strong> (<em>float</em>) – Chemical potential.</p></li>
<li><p><strong>error</strong> (<em>float</em>) – Error in the number of electrons.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW.fsgw">
<span id="momentgw-fsgw-module"></span><h2>momentGW.fsgw module<a class="headerlink" href="#module-momentGW.fsgw" title="Link to this heading">¶</a></h2>
<p>Spin-restricted Fock matrix self-consistent GW via self-energy moment
constraints for molecular systems.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.fsgw.</span></span><span class="sig-name descname"><span class="pre">fsGW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fsgw.fsGW" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.gw.GW" title="momentGW.gw.GW"><code class="xref py py-class docutils literal notranslate"><span class="pre">GW</span></code></a></p>
<p>Spin-restricted Fock matrix self-consistent GW via self-energy
moment constraints for molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>diagonal_se</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use a diagonal approximation in the self-energy.
Default value is <cite>False</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of numerical integration points. Default value is <cite>48</cite>.</p></li>
<li><p><strong>optimise_chempot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, optimise the chemical potential by shifting the
position of the poles in the self-energy relative to those in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>fock_loop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, self-consistently renormalise the density matrix
according to the updated Green’s function. Default value is
<cite>False</cite>.</p></li>
<li><p><strong>fock_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options passed to the Fock loop. For more details
see <cite>momentGW.fock</cite>.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Blocks of the ERIs to use as a metric for compression. Can be
one or more of <cite>(“oo”, “ov”, “vv”, “ia”)</cite> which can be passed as
a comma-separated string. <cite>“oo”</cite>, <cite>“ov”</cite> and <cite>“vv”</cite> refer to
compression on the initial ERIs, whereas <cite>“ia”</cite> refers to
compression on the ERIs entering RPA, which may change under a
self-consistent scheme. Default value is <cite>“ia”</cite>.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the compression. Default value is <cite>1e-10</cite>.</p></li>
<li><p><strong>thc_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options to be used for THC calculations. Current
implementation requires a filepath to import the THC integrals.</p></li>
<li><p><strong>max_cycle</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations. Default value is <cite>50</cite>.</p></li>
<li><p><strong>conv_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the HOMO and LUMO.
Default value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_tol_moms</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the moments. Default
value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_logical</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes an iterable of booleans as input indicating
whether the individual <cite>conv_tol</cite>, <cite>conv_tol_moms</cite> have been
satisfied, respectively, and returns a boolean indicating
overall convergence. For example, the function <cite>all</cite> requires
both metrics to be met, and <cite>any</cite> requires just one. Default
value is <cite>all</cite>.</p></li>
<li><p><strong>diis_space</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the DIIS extrapolation space. Default value is <cite>8</cite>.</p></li>
<li><p><strong>damping</strong> (<em>float</em><em>, </em><em>optional</em>) – Damping parameter. Default value is <cite>0.0</cite>.</p></li>
<li><p><strong>solver</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a><em>, </em><em>optional</em>) – Solver to use to obtain the self-energy. Compatible with any
<cite>BaseGW</cite>-like class. Default value is <cite>momentGW.gw.GW</cite>.</p></li>
<li><p><strong>solver_options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the solver. Default value is an
empty <cite>dict</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.check_convergence">
<span class="sig-name descname"><span class="pre">check_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_prev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fsgw.fsGW.check_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence, and print a summary of changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies.</p></li>
<li><p><strong>mo_energy_prev</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies from the previous iteration.</p></li>
<li><p><strong>th</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>th_prev</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy from the previous
iteration.</p></li>
<li><p><strong>tp</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
<li><p><strong>tp_prev</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy from the previous iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>conv</strong> – Convergence flag.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.conv_logical">
<span class="sig-name descname"><span class="pre">conv_logical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fsgw.fsGW.conv_logical" title="Link to this definition">¶</a></dt>
<dd><p>Return True if bool(x) is True for all values x in the iterable.</p>
<p>If the iterable is empty, return True.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.conv_tol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.conv_tol_moms">
<span class="sig-name descname"><span class="pre">conv_tol_moms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.conv_tol_moms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.damping">
<span class="sig-name descname"><span class="pre">damping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.damping" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.diis_space">
<span class="sig-name descname"><span class="pre">diis_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.diis_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.fock_loop">
<span class="sig-name descname"><span class="pre">fock_loop</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.fock_loop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.max_cycle">
<span class="sig-name descname"><span class="pre">max_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.max_cycle" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.fsgw.fsGW.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.optimise_chempot">
<span class="sig-name descname"><span class="pre">optimise_chempot</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.optimise_chempot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.project_basis">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">project_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fsgw.fsGW.project_basis" title="Link to this definition">¶</a></dt>
<dd><p>Project a matrix from one basis to another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>numpy.ndarray</em><em> or </em><em>dyson.Lehmann</em>) – Matrix to project. Can also be a <cite>dyson.Lehmann</cite> or object, in
which case the <cite>couplings</cite> attribute is projected.</p></li>
<li><p><strong>ovlp</strong> (<em>numpy.ndarray</em>) – Overlap matrix in the shared (AO) basis.</p></li>
<li><p><strong>mo1</strong> (<em>numpy.ndarray</em>) – First basis, rotates from the shared (AO) basis into the
basis of <cite>matrix</cite>.</p></li>
<li><p><strong>mo2</strong> (<em>numpy.ndarray</em>) – Second basis, rotates from the shared (AO) basis into the
desired basis of the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>projected_matrix</strong> – Matrix projected into the desired basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.self_energy_to_moments">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">self_energy_to_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fsgw.fsGW.self_energy_to_moments" title="Link to this definition">¶</a></dt>
<dd><p>Return the hole and particle moments for a self-energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy to compute the moments of.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>th</strong> (<em>numpy.ndarray</em>) – Hole moments.</p></li>
<li><p><strong>tp</strong> (<em>numpy.ndarray</em>) – Particle moments.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><a class="headerlink" href="#momentGW.fsgw.fsGW.solver" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#momentGW.gw.GW" title="momentGW.gw.GW"><code class="xref py py-class docutils literal notranslate"><span class="pre">GW</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.fsgw.fsGW.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#momentGW.fsgw.fsGW.solver_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.fsgw.kernel">
<span class="sig-prename descclassname"><span class="pre">momentGW.fsgw.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.fsgw.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Moment-constrained Fock matrix self-consistent GW.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used  as the initial guess instead of calculating them.
Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conv</strong> (<em>bool</em>) – Convergence flag.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>numpy.ndarray</em>) – Quasiparticle energies.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW.gw">
<span id="momentgw-gw-module"></span><h2>momentGW.gw module<a class="headerlink" href="#module-momentGW.gw" title="Link to this heading">¶</a></h2>
<p>Spin-restricted one-shot GW via self-energy moment constraints for
molecular systems.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.gw.GW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.gw.</span></span><span class="sig-name descname"><span class="pre">GW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGW</span></code></a></p>
<p>Spin-restricted one-shot GW via self-energy moment constraints for
molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>diagonal_se</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use a diagonal approximation in the self-energy.
Default value is <cite>False</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of numerical integration points. Default value is <cite>48</cite>.</p></li>
<li><p><strong>optimise_chempot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, optimise the chemical potential by shifting the
position of the poles in the self-energy relative to those in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>fock_loop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, self-consistently renormalise the density matrix
according to the updated Green’s function. Default value is
<cite>False</cite>.</p></li>
<li><p><strong>fock_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options passed to the Fock loop. For more details
see <cite>momentGW.fock</cite>.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Blocks of the ERIs to use as a metric for compression. Can be
one or more of <cite>(“oo”, “ov”, “vv”, “ia”)</cite> which can be passed as
a comma-separated string. <cite>“oo”</cite>, <cite>“ov”</cite> and <cite>“vv”</cite> refer to
compression on the initial ERIs, whereas <cite>“ia”</cite> refers to
compression on the ERIs entering RPA, which may change under a
self-consistent scheme. Default value is <cite>“ia”</cite>.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the compression. Default value is <cite>1e-10</cite>.</p></li>
<li><p><strong>thc_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options to be used for THC calculations. Current
implementation requires a filepath to import the THC integrals.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This approach is described in <a href="#id21"><span class="problematic" id="id11">[1]_</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>C. J. C. Scott, O. J. Backhouse, and G. H. Booth, 158, 12,
2023.</p>
</aside>
</aside>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Get the integrals object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transform</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to transform the integrals object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>integrals</strong> – Integrals object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals">Integrals</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">momentGW.ints.Integrals</span></code></a>, <a class="reference internal" href="#momentGW.thc.Integrals" title="momentGW.thc.Integrals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">momentGW.thc.Integrals</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.build_se_moments">
<span class="sig-name descname"><span class="pre">build_se_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.build_se_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the self-energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a>) – Integrals object.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments passed to polarizability class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>se_moments_hole</strong> (<em>numpy.ndarray</em>) – Moments of the hole self-energy. If <cite>self.diagonal_se</cite>,
non-diagonal elements are set to zero.</p></li>
<li><p><strong>se_moments_part</strong> (<em>numpy.ndarray</em>) – Moments of the particle self-energy. If <cite>self.diagonal_se</cite>,
non-diagonal elements are set to zero.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#momentGW.rpa.dRPA" title="momentGW.rpa.dRPA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">momentGW.rpa.dRPA</span></code></a>, <a class="reference internal" href="#momentGW.tda.dTDA" title="momentGW.tda.dTDA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">momentGW.tda.dTDA</span></code></a>, <a class="reference internal" href="#momentGW.thc.dTDA" title="momentGW.thc.dTDA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">momentGW.thc.dTDA</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.build_se_static">
<span class="sig-name descname"><span class="pre">build_se_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.build_se_static" title="Link to this definition">¶</a></dt>
<dd><p>Build the static part of the self-energy, including the Fock
matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a>) – Integrals object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>se_static</strong> – Static part of the self-energy. If <cite>self.diagonal_se</cite>,
non-diagonal elements are set to zero.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.energy_gm">
<span class="sig-name descname"><span class="pre">energy_gm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.energy_gm" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the two-body (Galitskii–Migdal) energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Green’s function object. If <cite>None</cite>, use <cite>self.gf</cite>. Default
value is <cite>None</cite>.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Self-energy object. If <cite>None</cite>, use <cite>self.se</cite>. Default value
is <cite>None</cite>.</p></li>
<li><p><strong>g0</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use the mean-field Green’s function. Default
value is <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_2b</strong> – Two-body energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.energy_hf">
<span class="sig-name descname"><span class="pre">energy_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.energy_hf" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the one-body (Hartree–Fock) energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Green’s function object. If <cite>None</cite>, use either <cite>self.gf</cite>, or
the mean-field Green’s function. Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_1b</strong> – One-body energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.energy_nuc">
<span class="sig-name descname"><span class="pre">energy_nuc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.energy_nuc" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the nuclear repulsion energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>e_nuc</strong> – Nuclear repulsion energy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.init_gf">
<span class="sig-name descname"><span class="pre">init_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.init_gf" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the mean-field Green’s function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_energy</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Molecular orbital energies. Default value is
<cite>self.mo_energy</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gf</strong> – Mean-field Green’s function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Driver for the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used instead of calculating them. Default value is
<cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>converged</strong> (<em>bool</em>) – Whether the solver converged. For single-shot calculations,
this is always <cite>True</cite>.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>NoneType</em>) – Quasiparticle energies. For most GW methods, this is <cite>None</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.make_rdm1" title="Link to this definition">¶</a></dt>
<dd><p>Get the first-order reduced density matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gf</strong> (<em>dyson.Lehmann</em><em>, </em><em>optional</em>) – Green’s function object. If <cite>None</cite>, use either <cite>self.gf</cite>, or
the mean-field Green’s function. Default value is <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rdm1</strong> – First-order reduced density matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.moment_error">
<span class="sig-name descname"><span class="pre">moment_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se_moments_hole</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_moments_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.moment_error" title="Link to this definition">¶</a></dt>
<dd><p>Return the error in the moments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>se_moments_hole</strong> (<em>numpy.ndarray</em>) – Moments of the hole self-energy.</p></li>
<li><p><strong>se_moments_part</strong> (<em>numpy.ndarray</em>) – Moments of the particle self-energy.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eh</strong> (<em>float</em>) – Error in the hole moments.</p></li>
<li><p><strong>ep</strong> (<em>float</em>) – Error in the particle moments.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.gw.GW.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.gw.GW.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.gw.GW.solve_dyson">
<span class="sig-name descname"><span class="pre">solve_dyson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se_moments_hole</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_moments_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_static</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.GW.solve_dyson" title="Link to this definition">¶</a></dt>
<dd><p>Solve the Dyson equation due to a self-energy resulting from a
list of hole and particle moments, along with a static
contribution.</p>
<p>Also finds a chemical potential best satisfying the physical
number of electrons. If <cite>self.optimise_chempot</cite>, this will
shift the self-energy poles relative to the Green’s function,
which is a partial self-consistency that better conserves the
particle number.</p>
<p>If <cite>self.fock_loop</cite>, this function will also require that the
outputted Green’s function is self-consistent with respect to
the corresponding density and Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>se_moments_hole</strong> (<em>numpy.ndarray</em>) – Moments of the hole self-energy.</p></li>
<li><p><strong>se_moments_part</strong> (<em>numpy.ndarray</em>) – Moments of the particle self-energy.</p></li>
<li><p><strong>se_static</strong> (<em>numpy.ndarray</em>) – Static part of the self-energy.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a>) – Integrals object. Required if <cite>self.fock_loop</cite> is <cite>True</cite>.
Default value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#momentGW.fock.FockLoop" title="momentGW.fock.FockLoop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">momentGW.fock.FockLoop</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.gw.kernel">
<span class="sig-prename descclassname"><span class="pre">momentGW.gw.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.gw.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Moment-constrained one-shot GW.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used instead of calculating them. Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conv</strong> (<em>bool</em>) – Convergence flag. Always <cite>True</cite> for GW, returned for
compatibility with other GW methods.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>numpy.ndarray</em>) – Quasiparticle energies. Always <cite>None</cite> for GW, returned for
compatibility with other GW methods.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This approach is described in <a href="#id22"><span class="problematic" id="id13">[1]_</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>C. J. C. Scott, O. J. Backhouse, and G. H. Booth, 158, 12,
2023.</p>
</aside>
</aside>
</dd></dl>

</section>
<section id="module-momentGW.ints">
<span id="momentgw-ints-module"></span><h2>momentGW.ints module<a class="headerlink" href="#module-momentGW.ints" title="Link to this heading">¶</a></h2>
<p>Integral helpers.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.ints.BaseIntegrals">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.ints.</span></span><span class="sig-name descname"><span class="pre">BaseIntegrals</span></span><a class="headerlink" href="#momentGW.ints.BaseIntegrals" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for integral containers.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.ints.Integrals">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.ints.</span></span><span class="sig-name descname"><span class="pre">Integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ia'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseIntegrals</span></code></a></p>
<p>Container for the density-fitted integrals required for GW methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_df</strong> (<em>pyscf.df.DF</em>) – Density fitting object.</p></li>
<li><p><strong>mo_coeff</strong> (<em>numpy.ndarray</em>) – Molecular orbital coefficients.</p></li>
<li><p><strong>mo_occ</strong> (<em>numpy.ndarray</em>) – Molecular orbital occupations.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Compression scheme to use. Default value is <cite>‘ia’</cite>. See
<cite>momentGW.gw</cite> for more details.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Compression tolerance. Default value is <cite>1e-10</cite>. See
<cite>momentGW.gw</cite> for more details.</p></li>
<li><p><strong>store_full</strong> (<em>bool</em><em>, </em><em>optional</em>) – Store the full MO integrals in memory. Default value is
<cite>False</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.Lia">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lia</span></span><a class="headerlink" href="#momentGW.ints.Integrals.Lia" title="Link to this definition">¶</a></dt>
<dd><p>Get the compressed <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">W</span> <span class="pre">occ,</span> <span class="pre">W</span> <span class="pre">vir)</span></code> integrals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.Lpq">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lpq</span></span><a class="headerlink" href="#momentGW.ints.Integrals.Lpq" title="Link to this definition">¶</a></dt>
<dd><p>Get the full uncompressed <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO,</span> <span class="pre">MO)</span></code> integrals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.Lpx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lpx</span></span><a class="headerlink" href="#momentGW.ints.Integrals.Lpx" title="Link to this definition">¶</a></dt>
<dd><p>Get the compressed <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO,</span> <span class="pre">G)</span></code> integrals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#momentGW.ints.Integrals.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Get the dtype of the integrals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.get_compression_metric">
<span class="sig-name descname"><span class="pre">get_compression_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.get_compression_metric" title="Link to this definition">¶</a></dt>
<dd><p>Return the compression metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rot</strong> – Rotation matrix into the compressed auxiliary space.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.get_fock" title="Link to this definition">¶</a></dt>
<dd><p>Build the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>numpy.ndarray</em>) – Density matrix.</p></li>
<li><p><strong>h1e</strong> (<em>numpy.ndarray</em>) – Core Hamiltonian matrix.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments for <cite>get_jk</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fock</strong> – Fock matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See <cite>get_jk</cite> for more information. The basis of <cite>h1e</cite> must be
the same as <cite>dm</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.get_j">
<span class="sig-name descname"><span class="pre">get_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.get_j" title="Link to this definition">¶</a></dt>
<dd><p>Build the J matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>numpy.ndarray</em>) – Density matrix.</p></li>
<li><p><strong>basis</strong> (<em>str</em><em>, </em><em>optional</em>) – Basis in which to build the J matrix. One of
<cite>(“ao”, “mo”)</cite>. Default value is <cite>“mo”</cite>.</p></li>
<li><p><strong>other</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object for the ket side. Allows inheritence for
mixed-spin evaluations. If <cite>None</cite>, use <cite>self</cite>. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vj</strong> – J matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The contraction is
<cite>J[p, q] = self[p, q] * other[r, s] * dm[r, s]</cite>, and the
bases must reflect shared indices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.get_jk" title="Link to this definition">¶</a></dt>
<dd><p>Build the J and K matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>vj</strong> (<em>numpy.ndarray</em>) – J matrix.</p></li>
<li><p><strong>vk</strong> (<em>numpy.ndarray</em>) – K matrix.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See <cite>get_j</cite> and <cite>get_k</cite> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.get_k">
<span class="sig-name descname"><span class="pre">get_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mo'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.get_k" title="Link to this definition">¶</a></dt>
<dd><p>Build the K matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>numpy.ndarray</em>) – Density matrix.</p></li>
<li><p><strong>basis</strong> (<em>str</em><em>, </em><em>optional</em>) – Basis in which to build the K matrix. One of
<cite>(“ao”, “mo”)</cite>. Default value is <cite>“mo”</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vk</strong> – K matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The contraction is
<cite>K[p, q] = self[r, q] * self[p, r] * dm[q, s]</cite>, and the
bases must reflect shared indices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.get_veff" title="Link to this definition">¶</a></dt>
<dd><p>Build the effective potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>veff</strong> (<em>numpy.ndarray</em>) – Effective potential.</p></li>
<li><p><strong>j</strong> (<em>numpy.ndarray, optional</em>) – J matrix. If <cite>None</cite>, compute it. Default value is <cite>None</cite>.</p></li>
<li><p><strong>k</strong> (<em>numpy.ndarray, optional</em>) – K matrix. If <cite>None</cite>, compute it. Default value is <cite>None</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See <cite>get_jk</cite> for more information.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.is_bare">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_bare</span></span><a class="headerlink" href="#momentGW.ints.Integrals.is_bare" title="Link to this definition">¶</a></dt>
<dd><p>Get a boolean flag indicating whether the integrals have
no self-consistencies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.mo_coeff_g">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_g</span></span><a class="headerlink" href="#momentGW.ints.Integrals.mo_coeff_g" title="Link to this definition">¶</a></dt>
<dd><p>Get the MO coefficients for the Green’s function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.mo_coeff_w">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_w</span></span><a class="headerlink" href="#momentGW.ints.Integrals.mo_coeff_w" title="Link to this definition">¶</a></dt>
<dd><p>Get the MO coefficients for the screened Coulomb interaction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.mo_occ_w">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ_w</span></span><a class="headerlink" href="#momentGW.ints.Integrals.mo_occ_w" title="Link to this definition">¶</a></dt>
<dd><p>Get the MO occupation numbers for the screened Coulomb
interaction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nao" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of AOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.naux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux</span></span><a class="headerlink" href="#momentGW.ints.Integrals.naux" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of auxiliary basis functions, after the
compression.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.naux_full">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux_full</span></span><a class="headerlink" href="#momentGW.ints.Integrals.naux_full" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of auxiliary basis functions, before the
compression.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nmo" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nmo_g">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo_g</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nmo_g" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of MOs for the Green’s function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nmo_w">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo_w</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nmo_w" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of MOs for the screened Coulomb interaction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nocc" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of occupied MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nocc_w">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc_w</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nocc_w" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of occupied MOs for the screened Coulomb
interaction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nvir" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of virtual MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.nvir_w">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir_w</span></span><a class="headerlink" href="#momentGW.ints.Integrals.nvir_w" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of virtual MOs for the screened Coulomb
interaction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_Lpq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_Lpx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_Lia</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transform the integrals in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>do_Lpq</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to compute the full <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO,</span> <span class="pre">MO)</span></code> array. Default
value is <cite>True</cite> if <cite>store_full</cite> is <cite>True</cite>, <cite>False</cite>
otherwise.</p></li>
<li><p><strong>do_Lpx</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to compute the compressed <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO,</span> <span class="pre">MO)</span></code> array.
Default value is <cite>True</cite>.</p></li>
<li><p><strong>do_Lia</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to compute the compressed <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">occ,</span> <span class="pre">vir)</span></code> array.
Default value is <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.ints.Integrals.update_coeffs">
<span class="sig-name descname"><span class="pre">update_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.Integrals.update_coeffs" title="Link to this definition">¶</a></dt>
<dd><p>Update the MO coefficients in-place for the Green’s function
and the screened Coulomb interaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_coeff_g</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Coefficients corresponding to the Green’s function. Default
value is <cite>None</cite>.</p></li>
<li><p><strong>mo_coeff_w</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Coefficients corresponding to the screened Coulomb
interaction. Default value is <cite>None</cite>.</p></li>
<li><p><strong>mo_occ_w</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Occupations corresponding to the screened Coulomb
interaction. Default value is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>mo_coeff_g</cite> is <cite>None</cite>, the Green’s function is assumed to
remain in the basis in which it was originally defined, and
vice-versa for <cite>mo_coeff_w</cite> and <cite>mo_occ_w</cite>. At least one of
<cite>mo_coeff_g</cite> and <cite>mo_coeff_w</cite> must be provided.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.ints.patch_df_loop">
<span class="sig-prename descclassname"><span class="pre">momentGW.ints.</span></span><span class="sig-name descname"><span class="pre">patch_df_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.patch_df_loop" title="Link to this definition">¶</a></dt>
<dd><p>Context manager for monkey patching PySCF’s density fitting objects
to loop over blocks of the auxiliary functions distributed over MPI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>with_df</strong> (<em>pyscf.df.DF</em>) – Density fitting object.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>with_df</strong> (<em>pyscf.df.DF</em>) – Density fitting object with monkey patched <cite>loop</cite> method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.ints.require_compression_metric">
<span class="sig-prename descclassname"><span class="pre">momentGW.ints.</span></span><span class="sig-name descname"><span class="pre">require_compression_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.ints.require_compression_metric" title="Link to this definition">¶</a></dt>
<dd><p>Determine the compression metric before running the function.</p>
</dd></dl>

</section>
<section id="module-momentGW.logging">
<span id="momentgw-logging-module"></span><h2>momentGW.logging module<a class="headerlink" href="#module-momentGW.logging" title="Link to this heading">¶</a></h2>
<p>Logging.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.logging.Status">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">Status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.Status" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A status spinner with nested status messages.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.logging.Table">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">Table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.Table" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></p>
<p>A table with additional context manager methods.</p>
<p class="rubric">Notes</p>
<p>Since the <cite>Live</cite> object is created with <cite>transient=True</cite>, tables
using the context manager will be removed from the display after
the context manager is exited. Tables should be manually printed
to the console if they are required to be displayed afterwards.</p>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.logging.Table.add_column">
<span class="sig-name descname"><span class="pre">add_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.Table.add_column" title="Link to this definition">¶</a></dt>
<dd><p>Add a column to the table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>RenderableType</em><em>, </em><em>optional</em>) – Text or renderable for the header.
Defaults to “”.</p></li>
<li><p><strong>footer</strong> (<em>RenderableType</em><em>, </em><em>optional</em>) – Text or renderable for the footer.
Defaults to “”.</p></li>
<li><p><strong>header_style</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Style</em><em>]</em><em>, </em><em>optional</em>) – Style for the header, or None for default. Defaults to None.</p></li>
<li><p><strong>footer_style</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Style</em><em>]</em><em>, </em><em>optional</em>) – Style for the footer, or None for default. Defaults to None.</p></li>
<li><p><strong>style</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Style</em><em>]</em><em>, </em><em>optional</em>) – Style for the column cells, or None for default. Defaults to None.</p></li>
<li><p><strong>justify</strong> (<em>JustifyMethod</em><em>, </em><em>optional</em>) – Alignment for cells. Defaults to “left”.</p></li>
<li><p><strong>vertical</strong> (<em>VerticalAlignMethod</em><em>, </em><em>optional</em>) – Vertical alignment, one of “top”, “middle”, or “bottom”. Defaults to “top”.</p></li>
<li><p><strong>overflow</strong> (<em>OverflowMethod</em>) – Overflow method: “crop”, “fold”, “ellipsis”. Defaults to “ellipsis”.</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – Desired width of column in characters, or None to fit to contents. Defaults to None.</p></li>
<li><p><strong>min_width</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Minimum width of column, or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no minimum. Defaults to None.</p></li>
<li><p><strong>max_width</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Maximum width of column, or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no maximum. Defaults to None.</p></li>
<li><p><strong>ratio</strong> (<em>int</em><em>, </em><em>optional</em>) – Flexible ratio for the column (requires <code class="docutils literal notranslate"><span class="pre">Table.expand</span></code> or <code class="docutils literal notranslate"><span class="pre">Table.width</span></code>). Defaults to None.</p></li>
<li><p><strong>no_wrap</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to disable wrapping of this column.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.logging.Table.add_row">
<span class="sig-name descname"><span class="pre">add_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.Table.add_row" title="Link to this definition">¶</a></dt>
<dd><p>Add a row of renderables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*renderables</strong> (<em>None</em><em> or </em><em>renderable</em>) – Each cell in a row must be a renderable object (including str),
or <code class="docutils literal notranslate"><span class="pre">None</span></code> for a blank cell.</p></li>
<li><p><strong>style</strong> (<em>StyleType</em><em>, </em><em>optional</em>) – An optional style to apply to the entire row. Defaults to None.</p></li>
<li><p><strong>end_section</strong> (<em>bool</em><em>, </em><em>optional</em>) – End a section and draw a line. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>errors.NotRenderableError</strong> – If you add something that can’t be rendered.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.dump_times">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">dump_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.dump_times" title="Link to this definition">¶</a></dt>
<dd><p>Print a table with the timings.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.init_logging">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">init_logging</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.init_logging" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the logging with a header.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.rate">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">good_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ok_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.rate" title="Link to this definition">¶</a></dt>
<dd><p>Return a colour rating based on a value and thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – The value to rate.</p></li>
<li><p><strong>good_threshold</strong> (<em>float</em>) – The threshold for a good rating.</p></li>
<li><p><strong>ok_threshold</strong> (<em>float</em>) – The threshold for an ok rating.</p></li>
<li><p><strong>invert</strong> (<em>bool</em><em>, </em><em>optional</em>) – Invert the rating. Default value is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>style</strong> – The style to use for the rating.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.time">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elapsed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.time" title="Link to this definition">¶</a></dt>
<dd><p>Record a time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The message to record.</p></li>
<li><p><strong>elapsed</strong> (<em>float</em>) – The time elapsed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.warn">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.warn" title="Link to this definition">¶</a></dt>
<dd><p>Print a message to the console with a warning comment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The message to print.</p></li>
<li><p><strong>args</strong> (<em>tuple</em>) – The arguments to format the message with.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments to pass to <cite>console.print</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.with_comment">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">with_comment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.with_comment" title="Link to this definition">¶</a></dt>
<dd><p>Run a function with a comment.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.with_modifiers">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">with_modifiers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.with_modifiers" title="Link to this definition">¶</a></dt>
<dd><p>Run a function with modified logging.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.with_silent">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">with_silent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.with_silent" title="Link to this definition">¶</a></dt>
<dd><p>Run a function silently.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.with_status">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">with_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.with_status" title="Link to this definition">¶</a></dt>
<dd><p>Run a function with a status spinner.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.with_table">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">with_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.with_table" title="Link to this definition">¶</a></dt>
<dd><p>Run a function with a table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.with_timer">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">with_timer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.with_timer" title="Link to this definition">¶</a></dt>
<dd><p>Run a function with a timer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.logging.write">
<span class="sig-prename descclassname"><span class="pre">momentGW.logging.</span></span><span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.logging.write" title="Link to this definition">¶</a></dt>
<dd><p>Print a message to the console.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The message to print.</p></li>
<li><p><strong>args</strong> (<em>tuple</em>) – The arguments to format the message with.</p></li>
<li><p><strong>comment</strong> (<em>str</em><em>, </em><em>optional</em>) – A comment to print alongside the message.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments to pass to <cite>console.print</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW.mpi_helper">
<span id="momentgw-mpi-helper-module"></span><h2>momentGW.mpi_helper module<a class="headerlink" href="#module-momentGW.mpi_helper" title="Link to this heading">¶</a></h2>
<p>Temporary workaround for <cite>mpi_helper</cite> functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="momentGW.mpi_helper.prange">
<span class="sig-prename descclassname"><span class="pre">momentGW.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.mpi_helper.prange" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-momentGW.qsgw">
<span id="momentgw-qsgw-module"></span><h2>momentGW.qsgw module<a class="headerlink" href="#module-momentGW.qsgw" title="Link to this heading">¶</a></h2>
<p>Spin-restricted quasiparticle self-consistent GW via self-energy moment
constraints for molecular systems.</p>
<dl class="py function">
<dt class="sig sig-object py" id="momentGW.qsgw.kernel">
<span class="sig-prename descclassname"><span class="pre">momentGW.qsgw.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Moment-constrained quasiparticle self-consistent GW.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used  as the initial guess instead of calculating them.
Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conv</strong> (<em>bool</em>) – Convergence flag.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>numpy.ndarray</em>) – Quasiparticle energies.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.qsgw.</span></span><span class="sig-name descname"><span class="pre">qsGW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.qsGW" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.gw.GW" title="momentGW.gw.GW"><code class="xref py py-class docutils literal notranslate"><span class="pre">GW</span></code></a></p>
<p>Spin-restricted quasiparticle self-consistent GW via self-energy
moment constraints for molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>diagonal_se</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use a diagonal approximation in the self-energy.
Default value is <cite>False</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of numerical integration points. Default value is <cite>48</cite>.</p></li>
<li><p><strong>optimise_chempot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, optimise the chemical potential by shifting the
position of the poles in the self-energy relative to those in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>fock_loop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, self-consistently renormalise the density matrix
according to the updated Green’s function. Default value is
<cite>False</cite>.</p></li>
<li><p><strong>fock_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options passed to the Fock loop. For more details
see <cite>momentGW.fock</cite>.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Blocks of the ERIs to use as a metric for compression. Can be
one or more of <cite>(“oo”, “ov”, “vv”, “ia”)</cite> which can be passed as
a comma-separated string. <cite>“oo”</cite>, <cite>“ov”</cite> and <cite>“vv”</cite> refer to
compression on the initial ERIs, whereas <cite>“ia”</cite> refers to
compression on the ERIs entering RPA, which may change under a
self-consistent scheme. Default value is <cite>“ia”</cite>.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the compression. Default value is <cite>1e-10</cite>.</p></li>
<li><p><strong>thc_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options to be used for THC calculations. Current
implementation requires a filepath to import the THC integrals.</p></li>
<li><p><strong>max_cycle</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations. Default value is <cite>50</cite>.</p></li>
<li><p><strong>max_cycle_qp</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations in the quasiparticle equation
loop. Default value is <cite>50</cite>.</p></li>
<li><p><strong>conv_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the HOMO and LUMO.
Default value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_tol_moms</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the moments. Default
value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_tol_qp</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the density matrix in
the quasiparticle equation loop. Default value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_logical</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes an iterable of booleans as input indicating
whether the individual <cite>conv_tol</cite>, <cite>conv_tol_moms</cite>,
<cite>conv_tol_qp</cite> have been satisfied, respectively, and returns a
boolean indicating overall convergence. For example, the
function <cite>all</cite> requires both metrics to be met, and <cite>any</cite>
requires just one. Default value is <cite>all</cite>.</p></li>
<li><p><strong>diis_space</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the DIIS extrapolation space. Default value is <cite>8</cite>.</p></li>
<li><p><strong>diis_space_qp</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the DIIS extrapolation space in the quasiparticle
loop. Default value is <cite>8</cite>.</p></li>
<li><p><strong>damping</strong> (<em>float</em><em>, </em><em>optional</em>) – Damping parameter. Default value is <cite>0.0</cite>.</p></li>
<li><p><strong>eta</strong> (<em>float</em><em>, </em><em>optional</em>) – Small value to regularise the self-energy. Default value is
<cite>1e-1</cite>.</p></li>
<li><p><strong>srg</strong> (<em>float</em><em>, </em><em>optional</em>) – If non-zero, use the similarity renormalisation group approach
of Marie and Loos in place of the <cite>eta</cite> regularisation. For
value recommendations refer to their paper (arXiv:2303.05984).
Default value is <cite>0.0</cite>.</p></li>
<li><p><strong>solver</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a><em>, </em><em>optional</em>) – Solver to use to obtain the self-energy. Compatible with any
<cite>BaseGW</cite>-like class. Default value is <cite>momentGW.gw.GW</cite>.</p></li>
<li><p><strong>solver_options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the solver. Default value is an
empty <cite>dict</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.build_static_potential">
<span class="sig-name descname"><span class="pre">build_static_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.qsGW.build_static_potential" title="Link to this definition">¶</a></dt>
<dd><p>Build the static potential approximation to the self-energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy to approximate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>se_qp</strong> – Static potential approximation to the self-energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.check_convergence">
<span class="sig-name descname"><span class="pre">check_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_prev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.qsGW.check_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence, and print a summary of changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies.</p></li>
<li><p><strong>mo_energy_prev</strong> (<em>numpy.ndarray</em>) – Molecular orbital energies from the previous iteration.</p></li>
<li><p><strong>th</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>th_prev</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy from the previous
iteration.</p></li>
<li><p><strong>tp</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
<li><p><strong>tp_prev</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy from the previous iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>conv</strong> – Convergence flag.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.conv_logical">
<span class="sig-name descname"><span class="pre">conv_logical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.qsGW.conv_logical" title="Link to this definition">¶</a></dt>
<dd><p>Return True if bool(x) is True for all values x in the iterable.</p>
<p>If the iterable is empty, return True.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.conv_tol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.conv_tol_moms">
<span class="sig-name descname"><span class="pre">conv_tol_moms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.conv_tol_moms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.conv_tol_qp">
<span class="sig-name descname"><span class="pre">conv_tol_qp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.conv_tol_qp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.damping">
<span class="sig-name descname"><span class="pre">damping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.damping" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.diis_space">
<span class="sig-name descname"><span class="pre">diis_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.diis_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.diis_space_qp">
<span class="sig-name descname"><span class="pre">diis_space_qp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.diis_space_qp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.eta">
<span class="sig-name descname"><span class="pre">eta</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.eta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.has_fock_loop">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_fock_loop</span></span><a class="headerlink" href="#momentGW.qsgw.qsGW.has_fock_loop" title="Link to this definition">¶</a></dt>
<dd><p>Get a boolean indicating whether the solver requires a Fock
loop. In qsGW, this is always <cite>True</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.max_cycle">
<span class="sig-name descname"><span class="pre">max_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.max_cycle" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.max_cycle_qp">
<span class="sig-name descname"><span class="pre">max_cycle_qp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.max_cycle_qp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.qsgw.qsGW.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.project_basis">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">project_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.qsGW.project_basis" title="Link to this definition">¶</a></dt>
<dd><p>Project a matrix from one basis to another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>numpy.ndarray</em><em> or </em><em>dyson.Lehmann</em>) – Matrix to project. Can also be a <cite>dyson.Lehmann</cite> or object, in
which case the <cite>couplings</cite> attribute is projected.</p></li>
<li><p><strong>ovlp</strong> (<em>numpy.ndarray</em>) – Overlap matrix in the shared (AO) basis.</p></li>
<li><p><strong>mo1</strong> (<em>numpy.ndarray</em>) – First basis, rotates from the shared (AO) basis into the
basis of <cite>matrix</cite>.</p></li>
<li><p><strong>mo2</strong> (<em>numpy.ndarray</em>) – Second basis, rotates from the shared (AO) basis into the
desired basis of the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>projected_matrix</strong> – Matrix projected into the desired basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or dyson.Lehmann</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.self_energy_to_moments">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">self_energy_to_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.qsgw.qsGW.self_energy_to_moments" title="Link to this definition">¶</a></dt>
<dd><p>Return the hole and particle moments for a self-energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy to compute the moments of.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>th</strong> (<em>numpy.ndarray</em>) – Hole moments.</p></li>
<li><p><strong>tp</strong> (<em>numpy.ndarray</em>) – Particle moments.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><a class="headerlink" href="#momentGW.qsgw.qsGW.solver" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#momentGW.gw.GW" title="momentGW.gw.GW"><code class="xref py py-class docutils literal notranslate"><span class="pre">GW</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.solver_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="momentGW.qsgw.qsGW.srg">
<span class="sig-name descname"><span class="pre">srg</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#momentGW.qsgw.qsGW.srg" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-momentGW.rpa">
<span id="momentgw-rpa-module"></span><h2>momentGW.rpa module<a class="headerlink" href="#module-momentGW.rpa" title="Link to this heading">¶</a></h2>
<p>Construct RPA moments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.rpa.</span></span><span class="sig-name descname"><span class="pre">dRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.tda.dTDA" title="momentGW.tda.dTDA"><code class="xref py py-class docutils literal notranslate"><span class="pre">dTDA</span></code></a></p>
<p>Compute the self-energy moments using dRPA and numerical integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>mo_energy</strong> (<em>dict</em><em>, </em><em>optional</em>) – Molecular orbital energies. Keys are “g” and “w” for the Green’s
function and screened Coulomb interaction, respectively.
If <cite>None</cite>, use <cite>gw.mo_energy</cite> for both. Default value is <cite>None</cite>.</p></li>
<li><p><strong>mo_occ</strong> (<em>dict</em><em>, </em><em>optional</em>) – Molecular orbital occupancies. Keys are “g” and “w” for the
Green’s function and screened Coulomb interaction, respectively.
If <cite>None</cite>, use <cite>gw.mo_occ</cite> for both. Default value is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See <cite>momentGW.tda.dTDA.__init__</cite> for initialisation details and
<cite>momentGW.tda.dTDA.kernel</cite> for calculation run details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.build_dd_moments">
<span class="sig-name descname"><span class="pre">build_dd_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.build_dd_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the density-density response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>integral</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Integral array, including the offset part. If <cite>None</cite>,
calculate from scratch. Default is <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moments</strong> – Moments of the density-density response.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.build_dd_moments_exact">
<span class="sig-name descname"><span class="pre">build_dd_moments_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.build_dd_moments_exact" title="Link to this definition">¶</a></dt>
<dd><p>Build the exact moments of the density-density response.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> – Moments of the density-density response.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.build_dp_moments">
<span class="sig-name descname"><span class="pre">build_dp_moments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.build_dp_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the dynamic polarizability for optical
spectra calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> – Moments of the dynamic polarizability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.estimate_error_clencur">
<span class="sig-name descname"><span class="pre">estimate_error_clencur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.estimate_error_clencur" title="Link to this definition">¶</a></dt>
<dd><p>Estimate the quadrature error for Clenshaw-Curtis quadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i4</strong> (<em>numpy.ndarray</em>) – Integral at one-quarter the number of points.</p></li>
<li><p><strong>i2</strong> (<em>numpy.ndarray</em>) – Integral at one-half the number of points.</p></li>
<li><p><strong>imag_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold to consider the imaginary part of a root to be zero.
Default value is <cite>1e-10</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>error</strong> – Estimated error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.eval_diag_main_integral">
<span class="sig-name descname"><span class="pre">eval_diag_main_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_eri</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.eval_diag_main_integral" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the diagonal of the main integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad</strong> (<em>tuple</em>) – The quadrature points and weights.</p></li>
<li><p><strong>d</strong> (<em>numpy.ndarray</em>) – Orbital energy differences.</p></li>
<li><p><strong>diag_eri</strong> (<em>numpy.ndarray</em>) – Diagonal of the ERIs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>integral</strong> – Main integral.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.eval_diag_offset_integral">
<span class="sig-name descname"><span class="pre">eval_diag_offset_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_eri</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.eval_diag_offset_integral" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the diagonal of the offset integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad</strong> (<em>tuple</em>) – The quadrature points and weights.</p></li>
<li><p><strong>d</strong> (<em>numpy.ndarray</em>) – Orbital energy differences.</p></li>
<li><p><strong>diag_eri</strong> (<em>numpy.ndarray</em>) – Diagonal of the ERIs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>integral</strong> – Offset integral.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.eval_main_integral">
<span class="sig-name descname"><span class="pre">eval_main_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lia</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.eval_main_integral" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the main integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad</strong> (<em>tuple</em>) – The quadrature points and weights.</p></li>
<li><p><strong>d</strong> (<em>numpy.ndarray</em>) – Orbital energy differences.</p></li>
<li><p><strong>Lia</strong> (<em>numpy.ndarray</em>) – The (aux, W occ, W vir) integral array. If <cite>None</cite>, use
<cite>self.integrals.Lia</cite>. Keyword argument allows for the use of
this function with <cite>uhf</cite> and <cite>pbc</cite> modules.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>integral</strong> – Offset integral.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.eval_offset_integral">
<span class="sig-name descname"><span class="pre">eval_offset_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lia</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.eval_offset_integral" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the offset integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad</strong> (<em>tuple</em>) – The quadrature points and weights.</p></li>
<li><p><strong>d</strong> (<em>numpy.ndarray</em>) – Orbital energy differences.</p></li>
<li><p><strong>Lia</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">W</span> <span class="pre">occ,</span> <span class="pre">W</span> <span class="pre">vir)</span></code> integral array. If <cite>None</cite>, use
<cite>self.integrals.Lia</cite>. Keyword argument allows for the use of
this function with <cite>uhf</cite> and <cite>pbc</cite> modules.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>integral</strong> – Offset integral.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.gen_clencur_quad_inf">
<span class="sig-name descname"><span class="pre">gen_clencur_quad_inf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">even</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.gen_clencur_quad_inf" title="Link to this definition">¶</a></dt>
<dd><p>Generate quadrature points and weights for Clenshaw-Curtis
quadrature over an <code class="docutils literal notranslate"><span class="pre">(-inf,</span> <span class="pre">+inf)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>even</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to assume an even grid. Default is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – Quadrature points.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – Quadrature weights.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.gen_gausslag_quad_semiinf">
<span class="sig-name descname"><span class="pre">gen_gausslag_quad_semiinf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.gen_gausslag_quad_semiinf" title="Link to this definition">¶</a></dt>
<dd><p>Generate quadrature points and weights for Gauss-Laguerre
quadrature over an <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">+inf)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – Quadrature points.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – Quadrature weights.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.get_optimal_quad">
<span class="sig-name descname"><span class="pre">get_optimal_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bare_quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.get_optimal_quad" title="Link to this definition">¶</a></dt>
<dd><p>Get the optimal quadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bare_quad</strong> (<em>tuple</em>) – The quadrature points and weights.</p></li>
<li><p><strong>integrand</strong> (<em>function</em>) – The integrand function.</p></li>
<li><p><strong>exact</strong> (<em>float</em>) – The exact value of the integral.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the integral. Default value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The quadrature points.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – The quadrature weights.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.integrate" title="Link to this definition">¶</a></dt>
<dd><p>Optimise the quadrature and perform the integration for the
zeroth moment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>integral</strong> – Integral array, including the offset part.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.optimise_main_quad">
<span class="sig-name descname"><span class="pre">optimise_main_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.optimise_main_quad" title="Link to this definition">¶</a></dt>
<dd><p>Optimise the grid spacing of Clenshaw-Curtis quadrature for the
main integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>numpy.ndarray</em>) – Orbital energy differences.</p></li>
<li><p><strong>diag_eri</strong> (<em>numpy.ndarray</em>) – Diagonal of the ERIs.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the integral. Default value is <cite>“main”</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The quadrature points.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – The quadrature weights.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.optimise_offset_quad">
<span class="sig-name descname"><span class="pre">optimise_offset_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'offset'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.optimise_offset_quad" title="Link to this definition">¶</a></dt>
<dd><p>Optimise the grid spacing of Gauss-Laguerre quadrature for the
offset integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>numpy.ndarray</em>) – Orbital energy differences.</p></li>
<li><p><strong>diag_eri</strong> (<em>numpy.ndarray</em>) – Diagonal of the ERIs.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the integral. Default value is <cite>“offset”</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The quadrature points.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – The quadrature weights.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.rpa.dRPA.rescale_quad">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rescale_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bare_quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.rpa.dRPA.rescale_quad" title="Link to this definition">¶</a></dt>
<dd><p>Rescale quadrature for grid space <cite>a</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bare_quad</strong> (<em>tuple</em>) – The quadrature points and weights.</p></li>
<li><p><strong>a</strong> (<em>float</em>) – Grid spacing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The quadrature points.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – The quadrature weights.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-momentGW.scgw">
<span id="momentgw-scgw-module"></span><h2>momentGW.scgw module<a class="headerlink" href="#module-momentGW.scgw" title="Link to this heading">¶</a></h2>
<p>Spin-restricted self-consistent GW via self-energy moment constraitns
for molecular systems.</p>
<dl class="py function">
<dt class="sig sig-object py" id="momentGW.scgw.kernel">
<span class="sig-prename descclassname"><span class="pre">momentGW.scgw.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.scgw.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Moment-constrained self-consistent GW.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>moments</strong> (<em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Tuple of (hole, particle) moments, if passed then they will
be used  as the initial guess instead of calculating them.
Default value is <cite>None</cite>.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a><em>, </em><em>optional</em>) – Integrals object. If <cite>None</cite>, generate from scratch. Default
value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conv</strong> (<em>bool</em>) – Convergence flag.</p></li>
<li><p><strong>gf</strong> (<em>dyson.Lehmann</em>) – Green’s function object.</p></li>
<li><p><strong>se</strong> (<em>dyson.Lehmann</em>) – Self-energy object.</p></li>
<li><p><strong>qp_energy</strong> (<em>numpy.ndarray</em>) – Quasiparticle energies. Always <cite>None</cite> for scGW, returned for
compatibility with other scGW methods.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.scgw.scGW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.scgw.</span></span><span class="sig-name descname"><span class="pre">scGW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.scgw.scGW" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.evgw.evGW" title="momentGW.evgw.evGW"><code class="xref py py-class docutils literal notranslate"><span class="pre">evGW</span></code></a></p>
<p>Spin-restricted self-consistent GW via self-energy moment
constraints for molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field class.</p></li>
<li><p><strong>diagonal_se</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use a diagonal approximation in the self-energy.
Default value is <cite>False</cite>.</p></li>
<li><p><strong>polarizability</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of polarizability to use, can be one of <cite>(“drpa”,
“drpa-exact”, “dtda”, “thc-dtda”). Default value is `”drpa”</cite>.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of numerical integration points. Default value is <cite>48</cite>.</p></li>
<li><p><strong>optimise_chempot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, optimise the chemical potential by shifting the
position of the poles in the self-energy relative to those in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>fock_loop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, self-consistently renormalise the density matrix
according to the updated Green’s function. Default value is
<cite>False</cite>.</p></li>
<li><p><strong>fock_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options passed to the Fock loop. For more details
see <cite>momentGW.fock</cite>.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Blocks of the ERIs to use as a metric for compression. Can be
one or more of <cite>(“oo”, “ov”, “vv”, “ia”)</cite> which can be passed as
a comma-separated string. <cite>“oo”</cite>, <cite>“ov”</cite> and <cite>“vv”</cite> refer to
compression on the initial ERIs, whereas <cite>“ia”</cite> refers to
compression on the ERIs entering RPA, which may change under a
self-consistent scheme. Default value is <cite>“ia”</cite>.</p></li>
<li><p><strong>compression_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the compression. Default value is <cite>1e-10</cite>.</p></li>
<li><p><strong>thc_opts</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of options to be used for THC calculations. Current
implementation requires a filepath to import the THC integrals.</p></li>
<li><p><strong>g0</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, do not self-consistently update the eigenvalues in
the Green’s function. Default value is <cite>False</cite>.</p></li>
<li><p><strong>w0</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, do not self-consistently update the eigenvalues in
the screened Coulomb interaction. Default value is <cite>False</cite>.</p></li>
<li><p><strong>max_cycle</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations. Default value is <cite>50</cite>.</p></li>
<li><p><strong>conv_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the HOMO and LUMO.
Default value is <cite>1e-8</cite>.</p></li>
<li><p><strong>conv_tol_moms</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence threshold in the change in the moments. Default
value is <cite>1e-8</cite>.</p></li>
<li><p><strong>diis_space</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the DIIS extrapolation space. Default value is <cite>8</cite>.</p></li>
<li><p><strong>damping</strong> (<em>float</em><em>, </em><em>optional</em>) – Damping parameter. Default value is <cite>0.0</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="momentGW.scgw.scGW.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#momentGW.scgw.scGW.name" title="Link to this definition">¶</a></dt>
<dd><p>Get the method name.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-momentGW.tda">
<span id="momentgw-tda-module"></span><h2>momentGW.tda module<a class="headerlink" href="#module-momentGW.tda" title="Link to this heading">¶</a></h2>
<p>Construct TDA moments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.tda.dTDA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.tda.</span></span><span class="sig-name descname"><span class="pre">dTDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Compute the self-energy moments using dTDA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><em>Integrals</em></a>) – Integrals object.</p></li>
<li><p><strong>mo_energy</strong> (<em>dict</em><em>, </em><em>optional</em>) – Molecular orbital energies. Keys are “g” and “w” for the Green’s
function and screened Coulomb interaction, respectively.
If <cite>None</cite>, use <cite>gw.mo_energy</cite> for both. Default value is <cite>None</cite>.</p></li>
<li><p><strong>mo_occ</strong> (<em>dict</em><em>, </em><em>optional</em>) – Molecular orbital occupancies. Keys are “g” and “w” for the
Green’s function and screened Coulomb interaction, respectively.
If <cite>None</cite>, use <cite>gw.mo_occ</cite> for both. Default value is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.build_dd_moment_inv">
<span class="sig-name descname"><span class="pre">build_dd_moment_inv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.build_dd_moment_inv" title="Link to this definition">¶</a></dt>
<dd><p>Build the first inverse (<cite>n=-1</cite>) moment of the density-density
response.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moment</strong> – First inverse (<cite>n=-1</cite>) moment of the density-density
response.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is not the full <cite>n=-1</cite> moment, which is</p>
<div class="math notranslate nohighlight">
\[\begin{split}D^{-1} - D^{-1} V^\dagger (I + V D^{-1} V^\dagger)^{-1} \\
        V D^{-1}\end{split}\]</div>
<p>but rather</p>
<div class="math notranslate nohighlight">
\[(I + V D^{-1} V^\dagger)^{-1} V D^{-1}\]</div>
<p>which ensures that the function scales properly. The final
contractions are done when constructing the matrix-vector
product.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.build_dd_moments">
<span class="sig-name descname"><span class="pre">build_dd_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.build_dd_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the density-density response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m0</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – The zeroth moment of the density-density response. If
<cite>None</cite>, use <cite>self.integrals.Lia</cite>. This argument allows for
custom starting points in the recursion i.e. in optical
spectra calculations. Default value is <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moments</strong> – Moments of the density-density response.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.build_dp_moments">
<span class="sig-name descname"><span class="pre">build_dp_moments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.build_dp_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the dynamic polarizability for optical
spectra calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> – Moments of the dynamic polarizability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.build_se_moments">
<span class="sig-name descname"><span class="pre">build_se_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moments_dd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.build_se_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the self-energy via convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments_dd</strong> (<em>numpy.ndarray</em>) – Moments of the density-density response.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments_occ</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>moments_vir</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.convolve">
<span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.convolve" title="Link to this definition">¶</a></dt>
<dd><p>Handle the convolution of the moments of the Green’s function
and screened Coulomb interaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta</strong> (<em>numpy.ndarray</em>) – Moments of the density-density response partly transformed
into moments of the screened Coulomb interaction.</p></li>
<li><p><strong>mo_energy_g</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Energies of the Green’s function. If <cite>None</cite>, use
<cite>self.mo_energy_g</cite>. Default value is <cite>None</cite>.</p></li>
<li><p><strong>eta_orders</strong> (<em>list</em><em>, </em><em>optional</em>) – List of orders for the rotated density-density moments in
<cite>eta</cite>. If <cite>None</cite>, assume it spans all required orders.
Default value is <cite>None</cite>.</p></li>
<li><p><strong>mo_occ_g</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Occupancies of the Green’s function. If <cite>None</cite>, use
<cite>self.mo_occ_g</cite>. Default value is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments_occ</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>moments_vir</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Run the polarizability calculation to compute moments of the
self-energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>exact</strong> (<em>bool</em><em>, </em><em>optional</em>) – Has no effect and is only present for compatibility with
<cite>dRPA</cite>. Default value is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments_occ</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>moments_vir</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.mpi_size">
<span class="sig-name descname"><span class="pre">mpi_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.mpi_size" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of states in the current process for total size
<cite>n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – Total size.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>size</strong> – Number of states in current process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.mpi_slice">
<span class="sig-name descname"><span class="pre">mpi_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.tda.dTDA.mpi_slice" title="Link to this definition">¶</a></dt>
<dd><p>Return the start and end index for the current process for total
size <cite>n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – Total size.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>p0</strong> (<em>int</em>) – Start index for current process.</p></li>
<li><p><strong>p1</strong> (<em>int</em>) – End index for current process.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.naux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux</span></span><a class="headerlink" href="#momentGW.tda.dTDA.naux" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of auxiliaries.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#momentGW.tda.dTDA.nmo" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.tda.dTDA.nov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nov</span></span><a class="headerlink" href="#momentGW.tda.dTDA.nov" title="Link to this definition">¶</a></dt>
<dd><p>Get the number of ov states in the screened Coulomb interaction.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-momentGW.thc">
<span id="momentgw-thc-module"></span><h2>momentGW.thc module<a class="headerlink" href="#module-momentGW.thc" title="Link to this heading">¶</a></h2>
<p>Tensor hyper-contraction.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.thc.Integrals">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.thc.</span></span><span class="sig-name descname"><span class="pre">Integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.Integrals" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.ints.Integrals" title="momentGW.ints.Integrals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integrals</span></code></a></p>
<p>Container for the tensor-hypercontracted integrals required for GW
methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_df</strong> (<em>pyscf.df.DF</em>) – Density fitting object.</p></li>
<li><p><strong>mo_coeff</strong> (<em>numpy.ndarray</em>) – Molecular orbital coefficients.</p></li>
<li><p><strong>mo_occ</strong> (<em>numpy.ndarray</em>) – Molecular orbital occupations.</p></li>
<li><p><strong>file_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the HDF5 file containing the integrals. Default value is
<cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.La">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">La</span></span><a class="headerlink" href="#momentGW.thc.Integrals.La" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">W</span> <span class="pre">vir)</span></code> array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.Li">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Li</span></span><a class="headerlink" href="#momentGW.thc.Integrals.Li" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">W</span> <span class="pre">occ)</span></code> array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.Lp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lp</span></span><a class="headerlink" href="#momentGW.thc.Integrals.Lp" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO)</span></code> array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.Lx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lx</span></span><a class="headerlink" href="#momentGW.thc.Integrals.Lx" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO)</span></code> array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.coll">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coll</span></span><a class="headerlink" href="#momentGW.thc.Integrals.coll" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO)</span></code> collocation array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.cou">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cou</span></span><a class="headerlink" href="#momentGW.thc.Integrals.cou" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">aux)</span></code> Coulomb array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.get_compression_metric">
<span class="sig-name descname"><span class="pre">get_compression_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.Integrals.get_compression_metric" title="Link to this definition">¶</a></dt>
<dd><p>Return the compression metric - not currently used in THC.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.get_j">
<span class="sig-name descname"><span class="pre">get_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mo'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.Integrals.get_j" title="Link to this definition">¶</a></dt>
<dd><p>Build the J matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>numpy.ndarray</em>) – Density matrix.</p></li>
<li><p><strong>basis</strong> (<em>str</em><em>, </em><em>optional</em>) – Basis in which to build the J matrix. One of
<cite>(“ao”, “mo”)</cite>. Default value is <cite>“mo”</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vj</strong> – J matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The basis of <cite>dm</cite> must be the same as <cite>basis</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.get_k">
<span class="sig-name descname"><span class="pre">get_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mo'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.Integrals.get_k" title="Link to this definition">¶</a></dt>
<dd><p>Build the K matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>numpy.ndarray</em>) – Density matrix.</p></li>
<li><p><strong>basis</strong> (<em>str</em><em>, </em><em>optional</em>) – Basis in which to build the K matrix. One of
<cite>(“ao”, “mo”)</cite>. Default value is <cite>“mo”</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vk</strong> – K matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The basis of <cite>dm</cite> must be the same as <cite>basis</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.import_thc_components">
<span class="sig-name descname"><span class="pre">import_thc_components</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.Integrals.import_thc_components" title="Link to this definition">¶</a></dt>
<dd><p>Import a HDF5 file containing a dictionary. The keys
<cite>“collocation_matrix”</cite> and a <cite>“coulomb_matrix”</cite> must exist, with
shapes <code class="docutils literal notranslate"><span class="pre">(MO,</span> <span class="pre">aux)</span></code> and <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">aux)</span></code>, respectively.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.Integrals.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_Lpq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_Lpx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_Lia</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.Integrals.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transform the integrals in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>do_Lpq</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO,</span> <span class="pre">MO)</span></code> array is required. In THC,
this requires the <cite>Lp</cite> array. Default value is <cite>True</cite>.</p></li>
<li><p><strong>do_Lpx</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">MO,</span> <span class="pre">MO)</span></code> array is required. In THC,
this requires the <cite>Lx</cite> array. Default value is <cite>True</cite>.</p></li>
<li><p><strong>do_Lia</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">occ,</span> <span class="pre">vir)</span></code> array is required. In THC,
this requires the <cite>Li</cite> and <cite>La</cite> arrays. Default value is
<cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.thc.dTDA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.thc.</span></span><span class="sig-name descname"><span class="pre">dTDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.dTDA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#momentGW.tda.dTDA" title="momentGW.tda.dTDA"><code class="xref py py-class docutils literal notranslate"><span class="pre">dTDA</span></code></a></p>
<p>Compute the self-energy moments using dTDA and numerical integration
with tensor-hypercontraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gw</strong> (<a class="reference internal" href="#momentGW.base.BaseGW" title="momentGW.base.BaseGW"><em>BaseGW</em></a>) – GW object.</p></li>
<li><p><strong>nmom_max</strong> (<em>int</em>) – Maximum moment number to calculate.</p></li>
<li><p><strong>integrals</strong> (<a class="reference internal" href="#momentGW.ints.BaseIntegrals" title="momentGW.ints.BaseIntegrals"><em>BaseIntegrals</em></a>) – Integrals object.</p></li>
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em><em> or </em><em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Molecular orbital energies. If a tuple is passed, the first
element corresponds to the Green’s function basis and the second to
the screened Coulomb interaction. Default value is that of
<cite>gw.mo_energy</cite>.</p></li>
<li><p><strong>mo_occ</strong> (<em>numpy.ndarray</em><em> or </em><em>tuple</em><em> of </em><em>numpy.ndarray</em><em>, </em><em>optional</em>) – Molecular orbital occupancies. If a tuple is passed, the first
element corresponds to the Green’s function basis and the second to
the screened Coulomb interaction. Default value is that of
<cite>gw.mo_occ</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.dTDA.La">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">La</span></span><a class="headerlink" href="#momentGW.thc.dTDA.La" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">W</span> <span class="pre">vir)</span></code> array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.dTDA.Li">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Li</span></span><a class="headerlink" href="#momentGW.thc.dTDA.Li" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">W</span> <span class="pre">occ)</span></code> array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.dTDA.build_dd_moments">
<span class="sig-name descname"><span class="pre">build_dd_moments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.dTDA.build_dd_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the density-density response using
tensor-hypercontraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> – Moments of the density-density response.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Unlike the standard <cite>momentGW.tda</cite> implementation, this method
scales as <span class="math notranslate nohighlight">\(O(N^3)\)</span> with system size instead of
<span class="math notranslate nohighlight">\(O(N^4)\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.thc.dTDA.build_se_moments">
<span class="sig-name descname"><span class="pre">build_se_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.thc.dTDA.build_se_moments" title="Link to this definition">¶</a></dt>
<dd><p>Build the moments of the self-energy via convolution with
tensor-hypercontraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments_dd</strong> (<em>numpy.ndarray</em>) – Moments of the density-density response.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments_occ</strong> (<em>numpy.ndarray</em>) – Moments of the occupied self-energy.</p></li>
<li><p><strong>moments_vir</strong> (<em>numpy.ndarray</em>) – Moments of the virtual self-energy.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="momentGW.thc.dTDA.cou">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cou</span></span><a class="headerlink" href="#momentGW.thc.dTDA.cou" title="Link to this definition">¶</a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">(aux,</span> <span class="pre">aux)</span></code> Coulomb array.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-momentGW.util">
<span id="momentgw-util-module"></span><h2>momentGW.util module<a class="headerlink" href="#module-momentGW.util" title="Link to this heading">¶</a></h2>
<p>Utility functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="momentGW.util.DIIS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.util.</span></span><span class="sig-name descname"><span class="pre">DIIS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.DIIS" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DIIS</span></code></p>
<p>Direct inversion of the iterative subspace (DIIS).</p>
<p class="rubric">Notes</p>
<p>For some reason, the default pyscf DIIS object can result in fully
linearly dependent error vectors in high-moment self-consistent
calculations. This class is a drop-in replacement with a fallback
in this case.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyscf.lib.diis.DIIS</span></code></dt><dd><p>PySCF DIIS object which this class extends.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.util.DIIS.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.DIIS.extrapolate" title="Link to this definition">¶</a></dt>
<dd><p>Extrapolate the DIIS vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nd</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of vectors to extrapolate. Default is <cite>None</cite>, which
extrapolates all vectors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>xnew</strong> – Extrapolated vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function improves the robustness of the DIIS procedure in
the event of linear dependencies.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyscf.lib.diis.DIIS.extrapolate</span></code></dt><dd><p>PySCF DIIS extrapolation which this function refactors.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.util.DIIS.update_with_complex_unravel">
<span class="sig-name descname"><span class="pre">update_with_complex_unravel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.DIIS.update_with_complex_unravel" title="Link to this definition">¶</a></dt>
<dd><p>Execute DIIS where the error vectors are unravelled to
concatenate the real and imaginary parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Array to update with DIIS.</p></li>
<li><p><strong>xerr</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Error metric for the array. Default is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> – Updated array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.util.SilentSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.util.</span></span><span class="sig-name descname"><span class="pre">SilentSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.SilentSCF" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Context manager to shut PySCF’s SCF classes up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – SCF object to silence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="momentGW.util.Timer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">momentGW.util.</span></span><span class="sig-name descname"><span class="pre">Timer</span></span><a class="headerlink" href="#momentGW.util.Timer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Timer class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="momentGW.util.Timer.format_time">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">format_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.Timer.format_time" title="Link to this definition">¶</a></dt>
<dd><p>Return a formatted time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seconds</strong> (<em>float</em>) – Time in seconds.</p></li>
<li><p><strong>precision</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of time units to display. Default is <cite>2</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>formatted</strong> – Formatted time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.util.Timer.lap">
<span class="sig-name descname"><span class="pre">lap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.Timer.lap" title="Link to this definition">¶</a></dt>
<dd><p>Return the time since the last call to <cite>lap</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lap</strong> – Lap time.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="momentGW.util.Timer.total">
<span class="sig-name descname"><span class="pre">total</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.Timer.total" title="Link to this definition">¶</a></dt>
<dd><p>Return the total time since initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>total</strong> – Total time.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.util.build_1h1p_energies">
<span class="sig-prename descclassname"><span class="pre">momentGW.util.</span></span><span class="sig-name descname"><span class="pre">build_1h1p_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.build_1h1p_energies" title="Link to this definition">¶</a></dt>
<dd><p>Construct an array of 1h1p energies where elements are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\\Delta_{ij} = \\epsilon_i - \\epsilon_j\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mo_energy</strong> (<em>numpy.ndarray</em><em> or </em><em>tuple</em><em> of </em><em>numpy.ndarray</em>) – Molecular orbital energies. If a tuple, the first element
is used for occupied orbitals and the second element is used
for virtual orbitals.</p></li>
<li><p><strong>mo_occ</strong> (<em>numpy.ndarray</em><em> or </em><em>tuple</em><em> of </em><em>numpy.ndarray</em>) – Molecular orbital occupancies. If a tuple, the first element
is used for occupied orbitals and the second element is used
for virtual orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong> – 1h1p energies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.util.einsum">
<span class="sig-prename descclassname"><span class="pre">momentGW.util.</span></span><span class="sig-name descname"><span class="pre">einsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">operands</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.einsum" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate an Einstein summation convention on the operands.</p>
<p>Using the Einstein summation convention, many common
multi-dimensional, linear algebraic array operations can be
represented in a simple fashion. In <em>implicit</em> mode <cite>einsum</cite>
computes these values.</p>
<p>In <em>explicit</em> mode, <cite>einsum</cite> provides further flexibility to compute
other array operations that might not be considered classical
Einstein summation operations, by disabling, or forcing summation
over specified subscript labels.</p>
<p>See the <cite>numpy.einsum</cite> documentation for clarification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operands</strong> (<em>list</em>) – Any valid input to <cite>numpy.einsum</cite>.</p></li>
<li><p><strong>out</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – If provided, the calculation is done into this array.</p></li>
<li><p><strong>contract</strong> (<em>callable</em><em>, </em><em>optional</em>) – The function to use for contraction. Default value is
<cite>_contract</cite>.</p></li>
<li><p><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, use the <cite>numpy.einsum_path</cite> to optimize the
contraction. Default value is <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong> – The calculation based on the Einstein summation convention.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.einsum</span></code></dt><dd><p>NumPy’s <cite>einsum</cite> function.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="momentGW.util.list_union">
<span class="sig-prename descclassname"><span class="pre">momentGW.util.</span></span><span class="sig-name descname"><span class="pre">list_union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#momentGW.util.list_union" title="Link to this definition">¶</a></dt>
<dd><p>Find the union of a list of lists, with the elements sorted
by their first occurrence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>list</em><em> of </em><em>list</em>) – Lists to find the union of.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – Union of the lists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-momentGW">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-momentGW" title="Link to this heading">¶</a></h2>
<section id="momentgw">
<h3>momentGW<a class="headerlink" href="#momentgw" title="Link to this heading">¶</a></h3>
<p>The <cite>momentGW</cite> package implements a wide range of GW methods according
to the moment-conserving formalism.</p>
<p class="rubric">Examples</p>
<p>Examples of usage can be found in the <cite>examples</cite> directory of the
repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python examples/00-moment_order.py
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Publications using <cite>momentGW</cite> should cite <a href="#id23"><span class="problematic" id="id15">[1]_</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="3">
<li><ol class="upperalpha simple" start="10">
<li><ol class="upperalpha simple" start="3">
<li><p>Scott, O. J. Backhouse, and G. H. Booth, 158, 12, 2023.</p></li>
</ol>
</li>
</ol>
</li>
</ol>
</aside>
</aside>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">momentGW</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Oliver J. Backhouse.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/api/momentGW.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>