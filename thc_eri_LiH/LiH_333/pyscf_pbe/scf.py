#!/usr/bin/env python

import os
from pyscf.pbc import gto, scf, dft, df
from pyscf.gto.basis import parse_nwchem
import pyscf_interface as pyscf_api

atom = '''
Li 0.00000000e+00 0.00000000e+00 0.00000000e+00
H  2.04150000e+00 2.04150000e+00 2.04150000e+00
Li 2.04150000e+00 2.04150000e+00 0.00000000e+00
H  4.08300000e+00 4.08300000e+00 2.04150000e+00
Li 4.08300000e+00 4.08300000e+00 0.00000000e+00
H  6.12450000e+00 6.12450000e+00 2.04150000e+00
Li 2.04150000e+00 3.95567955e-33 2.04150000e+00
H  4.08300000e+00 2.04150000e+00 4.08300000e+00
Li 4.08300000e+00 2.04150000e+00 2.04150000e+00
H  6.12450000e+00 4.08300000e+00 4.08300000e+00
Li 6.12450000e+00 4.08300000e+00 2.04150000e+00
H  8.16600000e+00 6.12450000e+00 4.08300000e+00
Li 4.08300000e+00 1.69827901e-32 4.08300000e+00
H  6.12450000e+00 2.04150000e+00 6.12450000e+00
Li 6.12450000e+00 2.04150000e+00 4.08300000e+00
H  8.16600000e+00 4.08300000e+00 6.12450000e+00
Li 8.16600000e+00 4.08300000e+00 4.08300000e+00
H  1.02075000e+01 6.12450000e+00 6.12450000e+00
Li 3.95567955e-33 2.04150000e+00 2.04150000e+00
H  2.04150000e+00 4.08300000e+00 4.08300000e+00
Li 2.04150000e+00 4.08300000e+00 2.04150000e+00
H  4.08300000e+00 6.12450000e+00 4.08300000e+00
Li 4.08300000e+00 6.12450000e+00 2.04150000e+00
H  6.12450000e+00 8.16600000e+00 4.08300000e+00
Li 2.04150000e+00 2.04150000e+00 4.08300000e+00
H  4.08300000e+00 4.08300000e+00 6.12450000e+00
Li 4.08300000e+00 4.08300000e+00 4.08300000e+00
H  6.12450000e+00 6.12450000e+00 6.12450000e+00
Li 6.12450000e+00 6.12450000e+00 4.08300000e+00
H  8.16600000e+00 8.16600000e+00 6.12450000e+00
Li 4.08300000e+00 2.04150000e+00 6.12450000e+00
H  6.12450000e+00 4.08300000e+00 8.16600000e+00
Li 6.12450000e+00 4.08300000e+00 6.12450000e+00
H  8.16600000e+00 6.12450000e+00 8.16600000e+00
Li 8.16600000e+00 6.12450000e+00 6.12450000e+00
H  1.02075000e+01 8.16600000e+00 8.16600000e+00
Li 1.69827901e-32 4.08300000e+00 4.08300000e+00
H  2.04150000e+00 6.12450000e+00 6.12450000e+00
Li 2.04150000e+00 6.12450000e+00 4.08300000e+00
H  4.08300000e+00 8.16600000e+00 6.12450000e+00
Li 4.08300000e+00 8.16600000e+00 4.08300000e+00
H  6.12450000e+00 1.02075000e+01 6.12450000e+00
Li 2.04150000e+00 4.08300000e+00 6.12450000e+00
H  4.08300000e+00 6.12450000e+00 8.16600000e+00
Li 4.08300000e+00 6.12450000e+00 6.12450000e+00
H  6.12450000e+00 8.16600000e+00 8.16600000e+00
Li 6.12450000e+00 8.16600000e+00 6.12450000e+00
H  8.16600000e+00 1.02075000e+01 8.16600000e+00
Li 4.08300000e+00 4.08300000e+00 8.16600000e+00
H  6.12450000e+00 6.12450000e+00 1.02075000e+01
Li 6.12450000e+00 6.12450000e+00 8.16600000e+00
H  8.16600000e+00 8.16600000e+00 1.02075000e+01
Li 8.16600000e+00 8.16600000e+00 8.16600000e+00
H  1.02075000e+01 1.02075000e+01 1.02075000e+01
'''

cell = gto.M(
    a = '''0.0, 6.1245, 6.1245
           6.1245, 0.0, 6.1245
           6.1245, 6.1245, 0.0''',
    atom = atom, 
    pseudo = 'gth-pbe',          
    basis = 'gth-dzvp-molopt-sr',
    verbose = 4
)

nk = [1,1,1] 
kpts = cell.make_kpts(nk)

kmf = scf.KRKS(cell, kpts)
kmf.xc = 'pbe'
kmf.kernel()
kmf.analyze()

if pyscf_api.dump_to_h5(kmf, MO=False, outdir='./', prefix='pyscf') != 0: 
    raise ValueError("pyscf_api.dump() fail!")

#if pyscf_api.dump_to_h5(kmf, MO=True, outdir='./', prefix='pyscf') != 0:
#    raise ValueError("pyscf_api.dump() fail!")
