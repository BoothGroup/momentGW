Mon Jun 26 17:18:36 EDT 2023
/mnt/sw/nix/store/6a11b1qfnfwxjzs8q4xnlid1z3mvkz9l-python-3.9.12-view/lib/python3.9/site-packages/h5py/__init__.py:36: UserWarning: h5py is running against HDF5 1.10.9 when it was built against 1.10.8, this may cause problems
  _warn(("h5py is running against HDF5 {0} when it was built against {1}, "
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

#INFO: **** input file is /mnt/ceph/users/cyeh/bdft_examples/thc_eris/LiH_supercell/222/scf.py ****
#!/usr/bin/env python

import os
from pyscf.pbc import gto, scf, dft, df
from pyscf.gto.basis import parse_nwchem
import pyscf_interface as pyscf_api

atom = '''
Li 0.     0.     0.    
H  2.0415 2.0415 2.0415
Li 2.0415 2.0415 0.    
H  4.083  4.083  2.0415
Li 2.0415 0.     2.0415
H  4.083  2.0415 4.083 
Li 4.083  2.0415 2.0415
H  6.1245 4.083  4.083 
Li 0.     2.0415 2.0415
H  2.0415 4.083  4.083 
Li 2.0415 4.083  2.0415
H  4.083  6.1245 4.083 
Li 2.0415 2.0415 4.083 
H  4.083  4.083  6.1245
Li 4.083  4.083  4.083 
H  6.1245 6.1245 6.1245'''

cell = gto.M(
    a = '''0.0, 4.083, 4.083
           4.083, 0.0, 4.083
           4.083, 4.083, 0.0''',
    atom = atom, 
    pseudo = 'gth-pbe',          
    basis = 'gth-dzvp-molopt-sr',
    verbose = 4
)

nk = [1,1,1] 
kpts = cell.make_kpts(nk)

kmf = scf.KRKS(cell, kpts)
kmf.xc = 'pbe'
kmf.kernel()
kmf.analyze()

if pyscf_api.dump_to_h5(kmf, MO=False, outdir='./', prefix='pyscf') != 0: 
    raise ValueError("pyscf_api.dump() fail!")

#if pyscf_api.dump_to_h5(kmf, MO=True, outdir='./', prefix='pyscf') != 0:
#    raise ValueError("pyscf_api.dump() fail!")
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='worker5103', release='5.15.117.1.fi', version='#1 SMP Sun Jun 18 18:32:44 EDT 2023', machine='x86_64')  Threads 8
Python 3.9.12 (main, Jun 28 2022, 13:26:56) 
[GCC 11.2.0]
numpy 1.24.2  scipy 1.8.0
Date: Mon Jun 26 17:18:41 2023
PySCF version 2.1.1
PySCF path  /mnt/home/cyeh/py_env/cny_py39/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 16
[INPUT] num. electrons = 32
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Li     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      2.041500000000   2.041500000000   2.041500000000 AA    3.857875883300   3.857875883300   3.857875883300 Bohr   0.0
[INPUT]  3 Li     2.041500000000   2.041500000000   0.000000000000 AA    3.857875883300   3.857875883300   0.000000000000 Bohr   0.0
[INPUT]  4 H      4.083000000000   4.083000000000   2.041500000000 AA    7.715751766599   7.715751766599   3.857875883300 Bohr   0.0
[INPUT]  5 Li     2.041500000000   0.000000000000   2.041500000000 AA    3.857875883300   0.000000000000   3.857875883300 Bohr   0.0
[INPUT]  6 H      4.083000000000   2.041500000000   4.083000000000 AA    7.715751766599   3.857875883300   7.715751766599 Bohr   0.0
[INPUT]  7 Li     4.083000000000   2.041500000000   2.041500000000 AA    7.715751766599   3.857875883300   3.857875883300 Bohr   0.0
[INPUT]  8 H      6.124500000000   4.083000000000   4.083000000000 AA   11.573627649899   7.715751766599   7.715751766599 Bohr   0.0
[INPUT]  9 Li     0.000000000000   2.041500000000   2.041500000000 AA    0.000000000000   3.857875883300   3.857875883300 Bohr   0.0
[INPUT] 10 H      2.041500000000   4.083000000000   4.083000000000 AA    3.857875883300   7.715751766599   7.715751766599 Bohr   0.0
[INPUT] 11 Li     2.041500000000   4.083000000000   2.041500000000 AA    3.857875883300   7.715751766599   3.857875883300 Bohr   0.0
[INPUT] 12 H      4.083000000000   6.124500000000   4.083000000000 AA    7.715751766599  11.573627649899   7.715751766599 Bohr   0.0
[INPUT] 13 Li     2.041500000000   2.041500000000   4.083000000000 AA    3.857875883300   3.857875883300   7.715751766599 Bohr   0.0
[INPUT] 14 H      4.083000000000   4.083000000000   6.124500000000 AA    7.715751766599   7.715751766599  11.573627649899 Bohr   0.0
[INPUT] 15 Li     4.083000000000   4.083000000000   4.083000000000 AA    7.715751766599   7.715751766599   7.715751766599 Bohr   0.0
[INPUT] 16 H      6.124500000000   6.124500000000   6.124500000000 AA   11.573627649899  11.573627649899  11.573627649899 Bohr   0.0

nuclear repulsion = -27.1584777031275
number of shells = 32
number of NR pGTOs = 320
number of NR cGTOs = 88
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:         1.73
lattice vectors  a1 [0.000000000, 7.715751767, 7.715751767]
                 a2 [7.715751767, 0.000000000, 7.715751767]
                 a3 [7.715751767, 7.715751767, 0.000000000]
dimension = 3
low_dim_ft_type = None
Cell volume = 918.681
rcut = 42.135626408510646 (nimgs = [5 5 5])
lattice sum = 815 cells
precision = 1e-08
pseudo = gth-pbe
ke_cutoff = 499.339343076142
    = [90 90 90] mesh (729000 PWs)


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS-KohnShamDFT
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmpp6086xs1
max_memory 4000 MB (current use 68 MB)


******** PBC SCF flags ********
N kpts = 1
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.29711052257609527
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -4.75376836122
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x15553f773070>
XC functionals = pbe
small_rho_cutoff = 1e-07
Uniform grid, mesh = [90 90 90]
Set gradient conv threshold to 0.000316228
init E= -60.2029815172471
HOMO = 0.0207119568588  LUMO = 0.0972464137203
cycle= 1 E= -64.2588171211895  delta_E= -4.06  |g|= 0.835  |ddm|= 36.9
HOMO = 0.0510371105287  LUMO = 0.131604407959
cycle= 2 E= -64.3477350449399  delta_E= -0.0889  |g|= 0.119  |ddm|= 24.1
HOMO = 0.0517951552439  LUMO = 0.130651330635
cycle= 3 E= -64.3496554133883  delta_E= -0.00192  |g|= 0.0062  |ddm|= 2.24
HOMO = 0.0507994412834  LUMO = 0.130559980656
cycle= 4 E= -64.3496712925471  delta_E= -1.59e-05  |g|= 0.0028  |ddm|= 0.0473
HOMO = 0.0507359125065  LUMO = 0.130568783867
cycle= 5 E= -64.3496753864174  delta_E= -4.09e-06  |g|= 0.000663  |ddm|= 0.0158
HOMO = 0.0508058405831  LUMO = 0.1305886822
cycle= 6 E= -64.3496755843738  delta_E= -1.98e-07  |g|= 7.2e-05  |ddm|= 0.00469
HOMO = 0.0508073095155  LUMO = 0.130589868567
cycle= 7 E= -64.349675586794  delta_E= -2.42e-09  |g|= 4.27e-06  |ddm|= 0.000418
HOMO = 0.0508070018681  LUMO = 0.130589876231
Extra cycle  E= -64.3496755867983  delta_E= -4.29e-12  |g|= 1.99e-06  |ddm|= 6.01e-05
converged SCF energy = -64.3496755867983
**** SCF Summaries ****
Total Energy =                         -64.349675586798327
Nuclear Repulsion Energy =             -27.158477703127460
One-electron Energy =                  -35.071579355316146
Two-electron Coulomb Energy =           15.743541399017177
DFT Exchange-Correlation Energy =      -17.863159927371900
Analyze output for *gamma point*
    To include the contributions from k-points, transform to a supercell then run the population analysis on the supercell
        from pyscf.pbc.tools import k2gamma
        k2gamma.k2gamma(mf).mulliken_meta()
KRHF mulliken_meta
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 Li 1s        1.99930
pop of  0 Li 2s        0.29415
pop of  0 Li 3s        0.00024
pop of  0 Li 2px       0.05332
pop of  0 Li 2py       0.05332
pop of  0 Li 2pz       0.05332
pop of  1 H 1s        1.54293
pop of  1 H 2s        0.00342
pop of  1 H 2px       0.00000
pop of  1 H 2py       0.00000
pop of  1 H 2pz       0.00000
pop of  2 Li 1s        1.99930
pop of  2 Li 2s        0.29415
pop of  2 Li 3s        0.00024
pop of  2 Li 2px       0.05332
pop of  2 Li 2py       0.05332
pop of  2 Li 2pz       0.05332
pop of  3 H 1s        1.54293
pop of  3 H 2s        0.00342
pop of  3 H 2px       0.00000
pop of  3 H 2py       0.00000
pop of  3 H 2pz       0.00000
pop of  4 Li 1s        1.99930
pop of  4 Li 2s        0.29415
pop of  4 Li 3s        0.00024
pop of  4 Li 2px       0.05332
pop of  4 Li 2py       0.05332
pop of  4 Li 2pz       0.05332
pop of  5 H 1s        1.54293
pop of  5 H 2s        0.00342
pop of  5 H 2px       0.00000
pop of  5 H 2py       0.00000
pop of  5 H 2pz       0.00000
pop of  6 Li 1s        1.99930
pop of  6 Li 2s        0.29415
pop of  6 Li 3s        0.00024
pop of  6 Li 2px       0.05332
pop of  6 Li 2py       0.05332
pop of  6 Li 2pz       0.05332
pop of  7 H 1s        1.54293
pop of  7 H 2s        0.00342
pop of  7 H 2px       0.00000
pop of  7 H 2py       0.00000
pop of  7 H 2pz       0.00000
pop of  8 Li 1s        1.99930
pop of  8 Li 2s        0.29415
pop of  8 Li 3s        0.00024
pop of  8 Li 2px       0.05332
pop of  8 Li 2py       0.05332
pop of  8 Li 2pz       0.05332
pop of  9 H 1s        1.54293
pop of  9 H 2s        0.00342
pop of  9 H 2px       0.00000
pop of  9 H 2py       0.00000
pop of  9 H 2pz       0.00000
pop of  10 Li 1s        1.99930
pop of  10 Li 2s        0.29415
pop of  10 Li 3s        0.00024
pop of  10 Li 2px       0.05332
pop of  10 Li 2py       0.05332
pop of  10 Li 2pz       0.05332
pop of  11 H 1s        1.54293
pop of  11 H 2s        0.00342
pop of  11 H 2px       0.00000
pop of  11 H 2py       0.00000
pop of  11 H 2pz       0.00000
pop of  12 Li 1s        1.99930
pop of  12 Li 2s        0.29415
pop of  12 Li 3s        0.00024
pop of  12 Li 2px       0.05332
pop of  12 Li 2py       0.05332
pop of  12 Li 2pz       0.05332
pop of  13 H 1s        1.54293
pop of  13 H 2s        0.00342
pop of  13 H 2px       0.00000
pop of  13 H 2py       0.00000
pop of  13 H 2pz       0.00000
pop of  14 Li 1s        1.99930
pop of  14 Li 2s        0.29415
pop of  14 Li 3s        0.00024
pop of  14 Li 2px       0.05332
pop of  14 Li 2py       0.05332
pop of  14 Li 2pz       0.05332
pop of  15 H 1s        1.54293
pop of  15 H 2s        0.00342
pop of  15 H 2px       0.00000
pop of  15 H 2py       0.00000
pop of  15 H 2pz       0.00000
 ** Mulliken atomic charges  **
charge of  0Li =      0.54636
charge of  1H =     -0.54636
charge of  2Li =      0.54636
charge of  3H =     -0.54636
charge of  4Li =      0.54636
charge of  5H =     -0.54636
charge of  6Li =      0.54636
charge of  7H =     -0.54636
charge of  8Li =      0.54636
charge of  9H =     -0.54636
charge of  10Li =      0.54636
charge of  11H =     -0.54636
charge of  12Li =      0.54636
charge of  13H =     -0.54636
charge of  14Li =      0.54636
charge of  15H =     -0.54636
# Dump the mean-field information from a pyscf calculation (HF/DFT) into ./pyscf.h5
Mon Jun 26 17:35:05 EDT 2023
