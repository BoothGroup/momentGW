<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rich.table &#8212; momentGW  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=a66d8bb5" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">momentGW</a></h1>










<div class="momentgw-badges">
    <a class="github-button" href="https://github.com/BoothGroup/momentGW" data-size="large"
        data-show-count="true" aria-label="Star BoothGroup/momentGW on GitHub">Star</a>
</div>

<script async defer src="https://buttons.github.io/buttons.js"></script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Documentation</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/BoothGroup/momentGW">GitHub</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/BoothGroup/momentGW/issues">Report Issues</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for rich.table</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">replace</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TYPE_CHECKING</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">NamedTuple</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">Sequence</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">box</span><span class="p">,</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">._loop</span> <span class="kn">import</span> <span class="n">loop_first_last</span><span class="p">,</span> <span class="n">loop_last</span>
<span class="kn">from</span> <span class="nn">._pick</span> <span class="kn">import</span> <span class="n">pick_bool</span>
<span class="kn">from</span> <span class="nn">._ratio</span> <span class="kn">import</span> <span class="n">ratio_distribute</span><span class="p">,</span> <span class="n">ratio_reduce</span>
<span class="kn">from</span> <span class="nn">.align</span> <span class="kn">import</span> <span class="n">VerticalAlignMethod</span>
<span class="kn">from</span> <span class="nn">.jupyter</span> <span class="kn">import</span> <span class="n">JupyterMixin</span>
<span class="kn">from</span> <span class="nn">.measure</span> <span class="kn">import</span> <span class="n">Measurement</span>
<span class="kn">from</span> <span class="nn">.padding</span> <span class="kn">import</span> <span class="n">Padding</span><span class="p">,</span> <span class="n">PaddingDimensions</span>
<span class="kn">from</span> <span class="nn">.protocol</span> <span class="kn">import</span> <span class="n">is_renderable</span>
<span class="kn">from</span> <span class="nn">.segment</span> <span class="kn">import</span> <span class="n">Segment</span>
<span class="kn">from</span> <span class="nn">.style</span> <span class="kn">import</span> <span class="n">Style</span><span class="p">,</span> <span class="n">StyleType</span>
<span class="kn">from</span> <span class="nn">.text</span> <span class="kn">import</span> <span class="n">Text</span><span class="p">,</span> <span class="n">TextType</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.console</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">Console</span><span class="p">,</span>
        <span class="n">ConsoleOptions</span><span class="p">,</span>
        <span class="n">JustifyMethod</span><span class="p">,</span>
        <span class="n">OverflowMethod</span><span class="p">,</span>
        <span class="n">RenderableType</span><span class="p">,</span>
        <span class="n">RenderResult</span><span class="p">,</span>
    <span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines a column within a ~Table.</span>

<span class="sd">    Args:</span>
<span class="sd">        title (Union[str, Text], optional): The title of the table rendered at the top. Defaults to None.</span>
<span class="sd">        caption (Union[str, Text], optional): The table caption rendered below. Defaults to None.</span>
<span class="sd">        width (int, optional): The width in characters of the table, or ``None`` to automatically fit. Defaults to None.</span>
<span class="sd">        min_width (Optional[int], optional): The minimum width of the table, or ``None`` for no minimum. Defaults to None.</span>
<span class="sd">        box (box.Box, optional): One of the constants in box.py used to draw the edges (see :ref:`appendix_box`), or ``None`` for no box lines. Defaults to box.HEAVY_HEAD.</span>
<span class="sd">        safe_box (Optional[bool], optional): Disable box characters that don&#39;t display on windows legacy terminal with *raster* fonts. Defaults to True.</span>
<span class="sd">        padding (PaddingDimensions, optional): Padding for cells (top, right, bottom, left). Defaults to (0, 1).</span>
<span class="sd">        collapse_padding (bool, optional): Enable collapsing of padding around cells. Defaults to False.</span>
<span class="sd">        pad_edge (bool, optional): Enable padding of edge cells. Defaults to True.</span>
<span class="sd">        expand (bool, optional): Expand the table to fit the available space if ``True``, otherwise the table width will be auto-calculated. Defaults to False.</span>
<span class="sd">        show_header (bool, optional): Show a header row. Defaults to True.</span>
<span class="sd">        show_footer (bool, optional): Show a footer row. Defaults to False.</span>
<span class="sd">        show_edge (bool, optional): Draw a box around the outside of the table. Defaults to True.</span>
<span class="sd">        show_lines (bool, optional): Draw lines between every row. Defaults to False.</span>
<span class="sd">        leading (bool, optional): Number of blank lines between rows (precludes ``show_lines``). Defaults to 0.</span>
<span class="sd">        style (Union[str, Style], optional): Default style for the table. Defaults to &quot;none&quot;.</span>
<span class="sd">        row_styles (List[Union, str], optional): Optional list of row styles, if more than one style is given then the styles will alternate. Defaults to None.</span>
<span class="sd">        header_style (Union[str, Style], optional): Style of the header. Defaults to &quot;table.header&quot;.</span>
<span class="sd">        footer_style (Union[str, Style], optional): Style of the footer. Defaults to &quot;table.footer&quot;.</span>
<span class="sd">        border_style (Union[str, Style], optional): Style of the border. Defaults to None.</span>
<span class="sd">        title_style (Union[str, Style], optional): Style of the title. Defaults to None.</span>
<span class="sd">        caption_style (Union[str, Style], optional): Style of the caption. Defaults to None.</span>
<span class="sd">        title_justify (str, optional): Justify method for title. Defaults to &quot;center&quot;.</span>
<span class="sd">        caption_justify (str, optional): Justify method for caption. Defaults to &quot;center&quot;.</span>
<span class="sd">        highlight (bool, optional): Highlight cell contents (if str). Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">header</span><span class="p">:</span> <span class="s2">&quot;RenderableType&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;RenderableType: Renderable for the header (typically a string)&quot;&quot;&quot;</span>

    <span class="n">footer</span><span class="p">:</span> <span class="s2">&quot;RenderableType&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;RenderableType: Renderable for the footer (typically a string)&quot;&quot;&quot;</span>

    <span class="n">header_style</span><span class="p">:</span> <span class="n">StyleType</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;StyleType: The style of the header.&quot;&quot;&quot;</span>

    <span class="n">footer_style</span><span class="p">:</span> <span class="n">StyleType</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;StyleType: The style of the footer.&quot;&quot;&quot;</span>

    <span class="n">style</span><span class="p">:</span> <span class="n">StyleType</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;StyleType: The style of the column.&quot;&quot;&quot;</span>

    <span class="n">justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;str: How to justify text within the column (&quot;left&quot;, &quot;center&quot;, &quot;right&quot;, or &quot;full&quot;)&quot;&quot;&quot;</span>

    <span class="n">vertical</span><span class="p">:</span> <span class="s2">&quot;VerticalAlignMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;str: How to vertically align content (&quot;top&quot;, &quot;middle&quot;, or &quot;bottom&quot;)&quot;&quot;&quot;</span>

    <span class="n">overflow</span><span class="p">:</span> <span class="s2">&quot;OverflowMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;ellipsis&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;str: Overflow method.&quot;&quot;&quot;</span>

    <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional[int]: Width of the column, or ``None`` (default) to auto calculate width.&quot;&quot;&quot;</span>

    <span class="n">min_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional[int]: Minimum width of column, or ``None`` for no minimum. Defaults to None.&quot;&quot;&quot;</span>

    <span class="n">max_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional[int]: Maximum width of column, or ``None`` for no maximum. Defaults to None.&quot;&quot;&quot;</span>

    <span class="n">ratio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional[int]: Ratio to use when calculating column width, or ``None`` (default) to adapt to column contents.&quot;&quot;&quot;</span>

    <span class="n">no_wrap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;bool: Prevent wrapping of text within the column. Defaults to ``False``.&quot;&quot;&quot;</span>

    <span class="n">_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Index of column.&quot;&quot;&quot;</span>

    <span class="n">_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;RenderableType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Column&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a copy of this Column.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_cells</span><span class="o">=</span><span class="p">[])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;RenderableType&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all cells in the column, not including header.&quot;&quot;&quot;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">flexible</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this column is flexible.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Row</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Information regarding a row.&quot;&quot;&quot;</span>

    <span class="n">style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Style to apply to row.&quot;&quot;&quot;</span>

    <span class="n">end_section</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicated end of section, which will force a line beneath the row.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">_Cell</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single cell in a table.&quot;&quot;&quot;</span>

    <span class="n">style</span><span class="p">:</span> <span class="n">StyleType</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Style to apply to cell.&quot;&quot;&quot;</span>
    <span class="n">renderable</span><span class="p">:</span> <span class="s2">&quot;RenderableType&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cell renderable.&quot;&quot;&quot;</span>
    <span class="n">vertical</span><span class="p">:</span> <span class="n">VerticalAlignMethod</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cell vertical alignment.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">JupyterMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A console renderable to draw a table.</span>

<span class="sd">    Args:</span>
<span class="sd">        *headers (Union[Column, str]): Column headers, either as a string, or :class:`~rich.table.Column` instance.</span>
<span class="sd">        title (Union[str, Text], optional): The title of the table rendered at the top. Defaults to None.</span>
<span class="sd">        caption (Union[str, Text], optional): The table caption rendered below. Defaults to None.</span>
<span class="sd">        width (int, optional): The width in characters of the table, or ``None`` to automatically fit. Defaults to None.</span>
<span class="sd">        min_width (Optional[int], optional): The minimum width of the table, or ``None`` for no minimum. Defaults to None.</span>
<span class="sd">        box (box.Box, optional): One of the constants in box.py used to draw the edges (see :ref:`appendix_box`), or ``None`` for no box lines. Defaults to box.HEAVY_HEAD.</span>
<span class="sd">        safe_box (Optional[bool], optional): Disable box characters that don&#39;t display on windows legacy terminal with *raster* fonts. Defaults to True.</span>
<span class="sd">        padding (PaddingDimensions, optional): Padding for cells (top, right, bottom, left). Defaults to (0, 1).</span>
<span class="sd">        collapse_padding (bool, optional): Enable collapsing of padding around cells. Defaults to False.</span>
<span class="sd">        pad_edge (bool, optional): Enable padding of edge cells. Defaults to True.</span>
<span class="sd">        expand (bool, optional): Expand the table to fit the available space if ``True``, otherwise the table width will be auto-calculated. Defaults to False.</span>
<span class="sd">        show_header (bool, optional): Show a header row. Defaults to True.</span>
<span class="sd">        show_footer (bool, optional): Show a footer row. Defaults to False.</span>
<span class="sd">        show_edge (bool, optional): Draw a box around the outside of the table. Defaults to True.</span>
<span class="sd">        show_lines (bool, optional): Draw lines between every row. Defaults to False.</span>
<span class="sd">        leading (bool, optional): Number of blank lines between rows (precludes ``show_lines``). Defaults to 0.</span>
<span class="sd">        style (Union[str, Style], optional): Default style for the table. Defaults to &quot;none&quot;.</span>
<span class="sd">        row_styles (List[Union, str], optional): Optional list of row styles, if more than one style is given then the styles will alternate. Defaults to None.</span>
<span class="sd">        header_style (Union[str, Style], optional): Style of the header. Defaults to &quot;table.header&quot;.</span>
<span class="sd">        footer_style (Union[str, Style], optional): Style of the footer. Defaults to &quot;table.footer&quot;.</span>
<span class="sd">        border_style (Union[str, Style], optional): Style of the border. Defaults to None.</span>
<span class="sd">        title_style (Union[str, Style], optional): Style of the title. Defaults to None.</span>
<span class="sd">        caption_style (Union[str, Style], optional): Style of the caption. Defaults to None.</span>
<span class="sd">        title_justify (str, optional): Justify method for title. Defaults to &quot;center&quot;.</span>
<span class="sd">        caption_justify (str, optional): Justify method for caption. Defaults to &quot;center&quot;.</span>
<span class="sd">        highlight (bool, optional): Highlight cell contents (if str). Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span>
    <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Row</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">headers</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Column</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TextType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">caption</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TextType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">box</span><span class="o">.</span><span class="n">Box</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">HEAVY_HEAD</span><span class="p">,</span>
        <span class="n">safe_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingDimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">collapse_padding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">pad_edge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">show_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">show_footer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">show_edge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">show_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">leading</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">StyleType</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">row_styles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">header_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;table.header&quot;</span><span class="p">,</span>
        <span class="n">footer_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;table.footer&quot;</span><span class="p">,</span>
        <span class="n">border_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">caption_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title_justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">caption_justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">highlight</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Row</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">caption</span> <span class="o">=</span> <span class="n">caption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="o">=</span> <span class="n">min_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safe_box</span> <span class="o">=</span> <span class="n">safe_box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_padding</span> <span class="o">=</span> <span class="n">Padding</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad_edge</span> <span class="o">=</span> <span class="n">pad_edge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expand</span> <span class="o">=</span> <span class="n">expand</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_header</span> <span class="o">=</span> <span class="n">show_header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_footer</span> <span class="o">=</span> <span class="n">show_footer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_edge</span> <span class="o">=</span> <span class="n">show_edge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_lines</span> <span class="o">=</span> <span class="n">show_lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leading</span> <span class="o">=</span> <span class="n">leading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collapse_padding</span> <span class="o">=</span> <span class="n">collapse_padding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header_style</span> <span class="o">=</span> <span class="n">header_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">footer_style</span> <span class="o">=</span> <span class="n">footer_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">border_style</span> <span class="o">=</span> <span class="n">border_style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_style</span> <span class="o">=</span> <span class="n">title_style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">caption_style</span> <span class="o">=</span> <span class="n">caption_style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="n">title_justify</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">caption_justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="n">caption_justify</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlight</span> <span class="o">=</span> <span class="n">highlight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_styles</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row_styles</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="n">append_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">append</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">header</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                <span class="n">append_column</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

<div class="viewcode-block" id="Table.grid">
<a class="viewcode-back" href="../../api/momentGW.logging.html#momentGW.logging.Table.grid">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="o">*</span><span class="n">headers</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Column</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingDimensions</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">collapse_padding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">pad_edge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a table with no lines, headers, or footer.</span>

<span class="sd">        Args:</span>
<span class="sd">            *headers (Union[Column, str]): Column headers, either as a string, or :class:`~rich.table.Column` instance.</span>
<span class="sd">            padding (PaddingDimensions, optional): Get padding around cells. Defaults to 0.</span>
<span class="sd">            collapse_padding (bool, optional): Enable collapsing of padding around cells. Defaults to True.</span>
<span class="sd">            pad_edge (bool, optional): Enable padding around edges of table. Defaults to False.</span>
<span class="sd">            expand (bool, optional): Expand the table to fit the available space if ``True``, otherwise the table width will be auto-calculated. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Table: A table instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="o">*</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">box</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
            <span class="n">collapse_padding</span><span class="o">=</span><span class="n">collapse_padding</span><span class="p">,</span>
            <span class="n">show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">show_footer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">show_edge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">pad_edge</span><span class="o">=</span><span class="n">pad_edge</span><span class="p">,</span>
            <span class="n">expand</span><span class="o">=</span><span class="n">expand</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setting a non-None self.width implies expand.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@expand</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set expand.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expand</span> <span class="o">=</span> <span class="n">expand</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_extra_width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get extra width to add to cell content.&quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_edge</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">row_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current number of rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>

<div class="viewcode-block" id="Table.get_row_style">
<a class="viewcode-back" href="../../api/momentGW.logging.html#momentGW.logging.Table.get_row_style">[docs]</a>
    <span class="k">def</span> <span class="nf">get_row_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StyleType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current row style.&quot;&quot;&quot;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">null</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_styles</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">+=</span> <span class="n">console</span><span class="o">.</span><span class="n">get_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_styles</span><span class="p">[</span><span class="n">index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_styles</span><span class="p">)])</span>
        <span class="n">row_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">style</span>
        <span class="k">if</span> <span class="n">row_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">+=</span> <span class="n">console</span><span class="o">.</span><span class="n">get_style</span><span class="p">(</span><span class="n">row_style</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">style</span></div>


    <span class="k">def</span> <span class="nf">__rich_measure__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="s2">&quot;ConsoleOptions&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Measurement</span><span class="p">:</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_width</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="k">if</span> <span class="n">max_width</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Measurement</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">extra_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_width</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_column_widths</span><span class="p">(</span>
                <span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">update_width</span><span class="p">(</span><span class="n">max_width</span> <span class="o">-</span> <span class="n">extra_width</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">_measure_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_measure_column</span>

        <span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">_measure_column</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">update_width</span><span class="p">(</span><span class="n">max_width</span><span class="p">),</span> <span class="n">column</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">]</span>
        <span class="n">minimum_width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">sum</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">minimum</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">measurements</span><span class="p">)</span> <span class="o">+</span> <span class="n">extra_width</span>
        <span class="p">)</span>
        <span class="n">maximum_width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">sum</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">maximum</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">measurements</span><span class="p">)</span> <span class="o">+</span> <span class="n">extra_width</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="p">)</span>
        <span class="n">measurement</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">minimum_width</span><span class="p">,</span> <span class="n">maximum_width</span><span class="p">)</span>
        <span class="n">measurement</span> <span class="o">=</span> <span class="n">measurement</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_width</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">measurement</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">padding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cell padding.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padding</span>

    <span class="nd">@padding</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">padding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingDimensions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set cell padding.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_padding</span> <span class="o">=</span> <span class="n">Padding</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">header</span><span class="p">:</span> <span class="s2">&quot;RenderableType&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">footer</span><span class="p">:</span> <span class="s2">&quot;RenderableType&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">header_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">footer_style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">vertical</span><span class="p">:</span> <span class="s2">&quot;VerticalAlignMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">overflow</span><span class="p">:</span> <span class="s2">&quot;OverflowMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;ellipsis&quot;</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">no_wrap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a column to the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            header (RenderableType, optional): Text or renderable for the header.</span>
<span class="sd">                Defaults to &quot;&quot;.</span>
<span class="sd">            footer (RenderableType, optional): Text or renderable for the footer.</span>
<span class="sd">                Defaults to &quot;&quot;.</span>
<span class="sd">            header_style (Union[str, Style], optional): Style for the header, or None for default. Defaults to None.</span>
<span class="sd">            footer_style (Union[str, Style], optional): Style for the footer, or None for default. Defaults to None.</span>
<span class="sd">            style (Union[str, Style], optional): Style for the column cells, or None for default. Defaults to None.</span>
<span class="sd">            justify (JustifyMethod, optional): Alignment for cells. Defaults to &quot;left&quot;.</span>
<span class="sd">            vertical (VerticalAlignMethod, optional): Vertical alignment, one of &quot;top&quot;, &quot;middle&quot;, or &quot;bottom&quot;. Defaults to &quot;top&quot;.</span>
<span class="sd">            overflow (OverflowMethod): Overflow method: &quot;crop&quot;, &quot;fold&quot;, &quot;ellipsis&quot;. Defaults to &quot;ellipsis&quot;.</span>
<span class="sd">            width (int, optional): Desired width of column in characters, or None to fit to contents. Defaults to None.</span>
<span class="sd">            min_width (Optional[int], optional): Minimum width of column, or ``None`` for no minimum. Defaults to None.</span>
<span class="sd">            max_width (Optional[int], optional): Maximum width of column, or ``None`` for no maximum. Defaults to None.</span>
<span class="sd">            ratio (int, optional): Flexible ratio for the column (requires ``Table.expand`` or ``Table.width``). Defaults to None.</span>
<span class="sd">            no_wrap (bool, optional): Set to ``True`` to disable wrapping of this column.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">column</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
            <span class="n">_index</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="n">footer</span><span class="o">=</span><span class="n">footer</span><span class="p">,</span>
            <span class="n">header_style</span><span class="o">=</span><span class="n">header_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">footer_style</span><span class="o">=</span><span class="n">footer_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span>
            <span class="n">vertical</span><span class="o">=</span><span class="n">vertical</span><span class="p">,</span>
            <span class="n">overflow</span><span class="o">=</span><span class="n">overflow</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
            <span class="n">min_width</span><span class="o">=</span><span class="n">min_width</span><span class="p">,</span>
            <span class="n">max_width</span><span class="o">=</span><span class="n">max_width</span><span class="p">,</span>
            <span class="n">ratio</span><span class="o">=</span><span class="n">ratio</span><span class="p">,</span>
            <span class="n">no_wrap</span><span class="o">=</span><span class="n">no_wrap</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_row</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">renderables</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;RenderableType&quot;</span><span class="p">],</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StyleType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end_section</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a row of renderables.</span>

<span class="sd">        Args:</span>
<span class="sd">            *renderables (None or renderable): Each cell in a row must be a renderable object (including str),</span>
<span class="sd">                or ``None`` for a blank cell.</span>
<span class="sd">            style (StyleType, optional): An optional style to apply to the entire row. Defaults to None.</span>
<span class="sd">            end_section (bool, optional): End a section and draw a line. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            errors.NotRenderableError: If you add something that can&#39;t be rendered.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">add_cell</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">renderable</span><span class="p">:</span> <span class="s2">&quot;RenderableType&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">column</span><span class="o">.</span><span class="n">_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">renderable</span><span class="p">)</span>

        <span class="n">cell_renderables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;RenderableType&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">renderables</span><span class="p">)</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_renderables</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">cell_renderables</span> <span class="o">=</span> <span class="p">[</span>
                <span class="o">*</span><span class="n">cell_renderables</span><span class="p">,</span>
                <span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_renderables</span><span class="p">)),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">renderable</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cell_renderables</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">column</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">_index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
                    <span class="n">add_cell</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">column</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">renderable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">add_cell</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_renderable</span><span class="p">(</span><span class="n">renderable</span><span class="p">):</span>
                <span class="n">add_cell</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">renderable</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">NotRenderableError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;unable to render </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">renderable</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">; a string or other renderable object is required&quot;</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Row</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">end_section</span><span class="o">=</span><span class="n">end_section</span><span class="p">))</span>

<div class="viewcode-block" id="Table.add_section">
<a class="viewcode-back" href="../../api/momentGW.logging.html#momentGW.logging.Table.add_section">[docs]</a>
    <span class="k">def</span> <span class="nf">add_section</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new section (draw a line after current row).&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">end_section</span> <span class="o">=</span> <span class="kc">True</span></div>


    <span class="k">def</span> <span class="nf">__rich_console__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="s2">&quot;ConsoleOptions&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RenderResult&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">Segment</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">max_width</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_width</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>

        <span class="n">extra_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_width</span>
        <span class="n">widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_column_widths</span><span class="p">(</span>
            <span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">update_width</span><span class="p">(</span><span class="n">max_width</span> <span class="o">-</span> <span class="n">extra_width</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">table_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span> <span class="o">+</span> <span class="n">extra_width</span>

        <span class="n">render_options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="n">table_width</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highlight</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">render_annotation</span><span class="p">(</span>
            <span class="n">text</span><span class="p">:</span> <span class="n">TextType</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">StyleType</span><span class="p">,</span> <span class="n">justify</span><span class="p">:</span> <span class="s2">&quot;JustifyMethod&quot;</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RenderResult&quot;</span><span class="p">:</span>
            <span class="n">render_text</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">console</span><span class="o">.</span><span class="n">render_str</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">text</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">console</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
                <span class="n">render_text</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">render_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">render_annotation</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">Style</span><span class="o">.</span><span class="n">pick_first</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title_style</span><span class="p">,</span> <span class="s2">&quot;table.title&quot;</span><span class="p">),</span>
                <span class="n">justify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_justify</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">render_options</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">caption</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">render_annotation</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">caption</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">Style</span><span class="o">.</span><span class="n">pick_first</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caption_style</span><span class="p">,</span> <span class="s2">&quot;table.caption&quot;</span><span class="p">),</span>
                <span class="n">justify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">caption_justify</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calculate_column_widths</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="s2">&quot;ConsoleOptions&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the widths of each column, including padding, not including borders.&quot;&quot;&quot;</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_width</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">width_ranges</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_measure_column</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span>
        <span class="p">]</span>
        <span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">_range</span><span class="o">.</span><span class="n">maximum</span> <span class="ow">or</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">_range</span> <span class="ow">in</span> <span class="n">width_ranges</span><span class="p">]</span>
        <span class="n">get_padding_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_padding_width</span>
        <span class="n">extra_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_width</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">:</span>
            <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">ratio</span> <span class="ow">or</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">flexible</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">ratios</span><span class="p">):</span>
                <span class="n">fixed_widths</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="mi">0</span> <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">flexible</span> <span class="k">else</span> <span class="n">_range</span><span class="o">.</span><span class="n">maximum</span>
                    <span class="k">for</span> <span class="n">_range</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">width_ranges</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">flex_minimum</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">width</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">get_padding_width</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span>
                    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">flexible</span>
                <span class="p">]</span>
                <span class="n">flexible_width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fixed_widths</span><span class="p">)</span>
                <span class="n">flex_widths</span> <span class="o">=</span> <span class="n">ratio_distribute</span><span class="p">(</span><span class="n">flexible_width</span><span class="p">,</span> <span class="n">ratios</span><span class="p">,</span> <span class="n">flex_minimum</span><span class="p">)</span>
                <span class="n">iter_flex_widths</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">flex_widths</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">flexible</span><span class="p">:</span>
                        <span class="n">widths</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">fixed_widths</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+</span> <span class="nb">next</span><span class="p">(</span><span class="n">iter_flex_widths</span><span class="p">)</span>
        <span class="n">table_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">table_width</span> <span class="o">&gt;</span> <span class="n">max_width</span><span class="p">:</span>
            <span class="n">widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collapse_widths</span><span class="p">(</span>
                <span class="n">widths</span><span class="p">,</span>
                <span class="p">[(</span><span class="n">column</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">column</span><span class="o">.</span><span class="n">no_wrap</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">],</span>
                <span class="n">max_width</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">table_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>
            <span class="c1"># last resort, reduce columns evenly</span>
            <span class="k">if</span> <span class="n">table_width</span> <span class="o">&gt;</span> <span class="n">max_width</span><span class="p">:</span>
                <span class="n">excess_width</span> <span class="o">=</span> <span class="n">table_width</span> <span class="o">-</span> <span class="n">max_width</span>
                <span class="n">widths</span> <span class="o">=</span> <span class="n">ratio_reduce</span><span class="p">(</span><span class="n">excess_width</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">widths</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
                <span class="n">table_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>

            <span class="n">width_ranges</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_measure_column</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">update_width</span><span class="p">(</span><span class="n">width</span><span class="p">),</span> <span class="n">column</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">_range</span><span class="o">.</span><span class="n">maximum</span> <span class="ow">or</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">_range</span> <span class="ow">in</span> <span class="n">width_ranges</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">table_width</span> <span class="o">&lt;</span> <span class="n">max_width</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">table_width</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="o">-</span> <span class="n">extra_width</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">_max_width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">max_width</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="o">-</span> <span class="n">extra_width</span><span class="p">,</span> <span class="n">max_width</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">pad_widths</span> <span class="o">=</span> <span class="n">ratio_distribute</span><span class="p">(</span><span class="n">_max_width</span> <span class="o">-</span> <span class="n">table_width</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
            <span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">_width</span> <span class="o">+</span> <span class="n">pad</span> <span class="k">for</span> <span class="n">_width</span><span class="p">,</span> <span class="n">pad</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">widths</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_collapse_widths</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">widths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">wrapable</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">max_width</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce widths so that the total is under max_width.</span>

<span class="sd">        Args:</span>
<span class="sd">            widths (List[int]): List of widths.</span>
<span class="sd">            wrapable (List[bool]): List of booleans that indicate if a column may shrink.</span>
<span class="sd">            max_width (int): Maximum width to reduce to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[int]: A new list of widths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>
        <span class="n">excess_width</span> <span class="o">=</span> <span class="n">total_width</span> <span class="o">-</span> <span class="n">max_width</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">wrapable</span><span class="p">):</span>
            <span class="k">while</span> <span class="n">total_width</span> <span class="ow">and</span> <span class="n">excess_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">max_column</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="n">width</span> <span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">allow_wrap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">wrapable</span><span class="p">)</span> <span class="k">if</span> <span class="n">allow_wrap</span>
                <span class="p">)</span>
                <span class="n">second_max_column</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="n">width</span> <span class="k">if</span> <span class="n">allow_wrap</span> <span class="ow">and</span> <span class="n">width</span> <span class="o">!=</span> <span class="n">max_column</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">allow_wrap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">wrapable</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">column_difference</span> <span class="o">=</span> <span class="n">max_column</span> <span class="o">-</span> <span class="n">second_max_column</span>
                <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">==</span> <span class="n">max_column</span> <span class="ow">and</span> <span class="n">allow_wrap</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">allow_wrap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">wrapable</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">column_difference</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">max_reduce</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">excess_width</span><span class="p">,</span> <span class="n">column_difference</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>
                <span class="n">widths</span> <span class="o">=</span> <span class="n">ratio_reduce</span><span class="p">(</span><span class="n">excess_width</span><span class="p">,</span> <span class="n">ratios</span><span class="p">,</span> <span class="n">max_reduce</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>

                <span class="n">total_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>
                <span class="n">excess_width</span> <span class="o">=</span> <span class="n">total_width</span> <span class="o">-</span> <span class="n">max_width</span>
        <span class="k">return</span> <span class="n">widths</span>

    <span class="k">def</span> <span class="nf">_get_cells</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">column_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="n">Column</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_Cell</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all the cells with padding and optional header.&quot;&quot;&quot;</span>

        <span class="n">collapse_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collapse_padding</span>
        <span class="n">pad_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_edge</span>
        <span class="n">padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
        <span class="n">any_padding</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>

        <span class="n">first_column</span> <span class="o">=</span> <span class="n">column_index</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">last_column</span> <span class="o">=</span> <span class="n">column_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">_padding_cache</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span> <span class="nf">get_padding</span><span class="p">(</span><span class="n">first_row</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">last_row</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
            <span class="n">cached</span> <span class="o">=</span> <span class="n">_padding_cache</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">first_row</span><span class="p">,</span> <span class="n">last_row</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cached</span>
            <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="n">padding</span>

            <span class="k">if</span> <span class="n">collapse_padding</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">first_column</span><span class="p">:</span>
                    <span class="n">left</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">left</span> <span class="o">-</span> <span class="n">right</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">last_row</span><span class="p">:</span>
                    <span class="n">bottom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span> <span class="o">-</span> <span class="n">bottom</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">pad_edge</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">first_column</span><span class="p">:</span>
                    <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">last_column</span><span class="p">:</span>
                    <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">first_row</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">last_row</span><span class="p">:</span>
                    <span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">_padding</span> <span class="o">=</span> <span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">)</span>
            <span class="n">_padding_cache</span><span class="p">[(</span><span class="n">first_row</span><span class="p">,</span> <span class="n">last_row</span><span class="p">)]</span> <span class="o">=</span> <span class="n">_padding</span>
            <span class="k">return</span> <span class="n">_padding</span>

        <span class="n">raw_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">StyleType</span><span class="p">,</span> <span class="s2">&quot;RenderableType&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">_append</span> <span class="o">=</span> <span class="n">raw_cells</span><span class="o">.</span><span class="n">append</span>
        <span class="n">get_style</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">get_style</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_header</span><span class="p">:</span>
            <span class="n">header_style</span> <span class="o">=</span> <span class="n">get_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">get_style</span><span class="p">(</span>
                <span class="n">column</span><span class="o">.</span><span class="n">header_style</span>
            <span class="p">)</span>
            <span class="n">_append</span><span class="p">((</span><span class="n">header_style</span><span class="p">,</span> <span class="n">column</span><span class="o">.</span><span class="n">header</span><span class="p">))</span>
        <span class="n">cell_style</span> <span class="o">=</span> <span class="n">get_style</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">column</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="n">_append</span><span class="p">((</span><span class="n">cell_style</span><span class="p">,</span> <span class="n">cell</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_footer</span><span class="p">:</span>
            <span class="n">footer_style</span> <span class="o">=</span> <span class="n">get_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">footer_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">get_style</span><span class="p">(</span>
                <span class="n">column</span><span class="o">.</span><span class="n">footer_style</span>
            <span class="p">)</span>
            <span class="n">_append</span><span class="p">((</span><span class="n">footer_style</span><span class="p">,</span> <span class="n">column</span><span class="o">.</span><span class="n">footer</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">any_padding</span><span class="p">:</span>
            <span class="n">_Padding</span> <span class="o">=</span> <span class="n">Padding</span>
            <span class="k">for</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">renderable</span><span class="p">)</span> <span class="ow">in</span> <span class="n">loop_first_last</span><span class="p">(</span><span class="n">raw_cells</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">_Cell</span><span class="p">(</span>
                    <span class="n">style</span><span class="p">,</span>
                    <span class="n">_Padding</span><span class="p">(</span><span class="n">renderable</span><span class="p">,</span> <span class="n">get_padding</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)),</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">renderable</span><span class="p">,</span> <span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">column</span><span class="o">.</span><span class="n">vertical</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">style</span><span class="p">,</span> <span class="n">renderable</span> <span class="ow">in</span> <span class="n">raw_cells</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">_Cell</span><span class="p">(</span>
                    <span class="n">style</span><span class="p">,</span>
                    <span class="n">renderable</span><span class="p">,</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">renderable</span><span class="p">,</span> <span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">column</span><span class="o">.</span><span class="n">vertical</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_padding_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get extra width from padding.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">pad_right</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">pad_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collapse_padding</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pad_left</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pad_left</span> <span class="o">-</span> <span class="n">pad_right</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pad_left</span> <span class="o">+</span> <span class="n">pad_right</span>

    <span class="k">def</span> <span class="nf">_measure_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span>
        <span class="n">options</span><span class="p">:</span> <span class="s2">&quot;ConsoleOptions&quot;</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Measurement</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the minimum and maximum width of the column.&quot;&quot;&quot;</span>

        <span class="n">max_width</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_width</span>
        <span class="k">if</span> <span class="n">max_width</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Measurement</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">padding_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_padding_width</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Fixed width column</span>
            <span class="k">return</span> <span class="n">Measurement</span><span class="p">(</span>
                <span class="n">column</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">padding_width</span><span class="p">,</span> <span class="n">column</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">padding_width</span>
            <span class="p">)</span><span class="o">.</span><span class="n">with_maximum</span><span class="p">(</span><span class="n">max_width</span><span class="p">)</span>
        <span class="c1"># Flexible column, we need to measure contents</span>
        <span class="n">min_widths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">max_widths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">append_min</span> <span class="o">=</span> <span class="n">min_widths</span><span class="o">.</span><span class="n">append</span>
        <span class="n">append_max</span> <span class="o">=</span> <span class="n">max_widths</span><span class="o">.</span><span class="n">append</span>
        <span class="n">get_render_width</span> <span class="o">=</span> <span class="n">Measurement</span><span class="o">.</span><span class="n">get</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cells</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">column</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span> <span class="o">=</span> <span class="n">get_render_width</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">renderable</span><span class="p">)</span>
            <span class="n">append_min</span><span class="p">(</span><span class="n">_min</span><span class="p">)</span>
            <span class="n">append_max</span><span class="p">(</span><span class="n">_max</span><span class="p">)</span>

        <span class="n">measurement</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span>
            <span class="nb">max</span><span class="p">(</span><span class="n">min_widths</span><span class="p">)</span> <span class="k">if</span> <span class="n">min_widths</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nb">max</span><span class="p">(</span><span class="n">max_widths</span><span class="p">)</span> <span class="k">if</span> <span class="n">max_widths</span> <span class="k">else</span> <span class="n">max_width</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">with_maximum</span><span class="p">(</span><span class="n">max_width</span><span class="p">)</span>
        <span class="n">measurement</span> <span class="o">=</span> <span class="n">measurement</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span>
            <span class="kc">None</span> <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">min_width</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">column</span><span class="o">.</span><span class="n">min_width</span> <span class="o">+</span> <span class="n">padding_width</span><span class="p">,</span>
            <span class="kc">None</span> <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">max_width</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">column</span><span class="o">.</span><span class="n">max_width</span> <span class="o">+</span> <span class="n">padding_width</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">measurement</span>

    <span class="k">def</span> <span class="nf">_render</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">:</span> <span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="s2">&quot;ConsoleOptions&quot;</span><span class="p">,</span> <span class="n">widths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RenderResult&quot;</span><span class="p">:</span>
        <span class="n">table_style</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">get_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">border_style</span> <span class="o">=</span> <span class="n">table_style</span> <span class="o">+</span> <span class="n">console</span><span class="o">.</span><span class="n">get_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">border_style</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">_column_cells</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_cells</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">column_index</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">column_index</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">row_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_Cell</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">_column_cells</span><span class="p">))</span>
        <span class="n">_box</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span>
                <span class="n">options</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="n">pick_bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_box</span><span class="p">,</span> <span class="n">console</span><span class="o">.</span><span class="n">safe_box</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">_box</span> <span class="o">=</span> <span class="n">_box</span><span class="o">.</span><span class="n">get_plain_headed_box</span><span class="p">()</span> <span class="k">if</span> <span class="n">_box</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_header</span> <span class="k">else</span> <span class="n">_box</span>

        <span class="n">new_line</span> <span class="o">=</span> <span class="n">Segment</span><span class="o">.</span><span class="n">line</span><span class="p">()</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">show_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_header</span>
        <span class="n">show_footer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_footer</span>
        <span class="n">show_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_edge</span>
        <span class="n">show_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_lines</span>
        <span class="n">leading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leading</span>

        <span class="n">_Segment</span> <span class="o">=</span> <span class="n">Segment</span>
        <span class="k">if</span> <span class="n">_box</span><span class="p">:</span>
            <span class="n">box_segments</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">head_left</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">head_right</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">head_vertical</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">foot_left</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">foot_right</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">foot_vertical</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">mid_left</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">mid_right</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                    <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">mid_vertical</span><span class="p">,</span> <span class="n">border_style</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">show_edge</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">get_top</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">border_style</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">new_line</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">box_segments</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">get_row_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_row_style</span>
        <span class="n">get_style</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">get_style</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="n">row_cell</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loop_first_last</span><span class="p">(</span><span class="n">row_cells</span><span class="p">)):</span>
            <span class="n">header_row</span> <span class="o">=</span> <span class="n">first</span> <span class="ow">and</span> <span class="n">show_header</span>
            <span class="n">footer_row</span> <span class="o">=</span> <span class="n">last</span> <span class="ow">and</span> <span class="n">show_footer</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="n">show_header</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">header_row</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">footer_row</span><span class="p">)</span>
                <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="n">max_height</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Segment</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">header_row</span> <span class="ow">or</span> <span class="n">footer_row</span><span class="p">:</span>
                <span class="n">row_style</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">null</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_style</span> <span class="o">=</span> <span class="n">get_style</span><span class="p">(</span>
                    <span class="n">get_row_style</span><span class="p">(</span><span class="n">console</span><span class="p">,</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">show_header</span> <span class="k">else</span> <span class="n">index</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">row_cell</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
                <span class="n">render_options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                    <span class="n">justify</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">justify</span><span class="p">,</span>
                    <span class="n">no_wrap</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">no_wrap</span><span class="p">,</span>
                    <span class="n">overflow</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">overflow</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">render_lines</span><span class="p">(</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">renderable</span><span class="p">,</span>
                    <span class="n">render_options</span><span class="p">,</span>
                    <span class="n">style</span><span class="o">=</span><span class="n">get_style</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">style</span><span class="p">)</span> <span class="o">+</span> <span class="n">row_style</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">max_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_height</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

            <span class="n">row_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">align_cell</span><span class="p">(</span>
                <span class="n">cell</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Segment</span><span class="p">]],</span>
                <span class="n">vertical</span><span class="p">:</span> <span class="s2">&quot;VerticalAlignMethod&quot;</span><span class="p">,</span>
                <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                <span class="n">style</span><span class="p">:</span> <span class="n">Style</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Segment</span><span class="p">]]:</span>
                <span class="k">if</span> <span class="n">header_row</span><span class="p">:</span>
                    <span class="n">vertical</span> <span class="o">=</span> <span class="s2">&quot;bottom&quot;</span>
                <span class="k">elif</span> <span class="n">footer_row</span><span class="p">:</span>
                    <span class="n">vertical</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span>

                <span class="k">if</span> <span class="n">vertical</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_Segment</span><span class="o">.</span><span class="n">align_top</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">row_height</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">vertical</span> <span class="o">==</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_Segment</span><span class="o">.</span><span class="n">align_middle</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">row_height</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_Segment</span><span class="o">.</span><span class="n">align_bottom</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">row_height</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>

            <span class="n">cells</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">_Segment</span><span class="o">.</span><span class="n">set_shape</span><span class="p">(</span>
                    <span class="n">align_cell</span><span class="p">(</span>
                        <span class="n">cell</span><span class="p">,</span>
                        <span class="n">_cell</span><span class="o">.</span><span class="n">vertical</span><span class="p">,</span>
                        <span class="n">width</span><span class="p">,</span>
                        <span class="n">get_style</span><span class="p">(</span><span class="n">_cell</span><span class="o">.</span><span class="n">style</span><span class="p">)</span> <span class="o">+</span> <span class="n">row_style</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">width</span><span class="p">,</span>
                    <span class="n">max_height</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">_cell</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">row_cell</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="n">_box</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">last</span> <span class="ow">and</span> <span class="n">show_footer</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">_Segment</span><span class="p">(</span>
                        <span class="n">_box</span><span class="o">.</span><span class="n">get_row</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="s2">&quot;foot&quot;</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">show_edge</span><span class="p">),</span> <span class="n">border_style</span>
                    <span class="p">)</span>
                    <span class="k">yield</span> <span class="n">new_line</span>
                <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">_divider</span> <span class="o">=</span> <span class="n">box_segments</span><span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">first</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">last</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)]</span>

                <span class="c1"># If the column divider is whitespace also style it with the row background</span>
                <span class="n">divider</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">_divider</span>
                    <span class="k">if</span> <span class="n">_divider</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">else</span> <span class="n">_Segment</span><span class="p">(</span>
                        <span class="n">_divider</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">row_style</span><span class="o">.</span><span class="n">background_style</span> <span class="o">+</span> <span class="n">_divider</span><span class="o">.</span><span class="n">style</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">line_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_height</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">show_edge</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">left</span>
                    <span class="k">for</span> <span class="n">last_cell</span><span class="p">,</span> <span class="n">rendered_cell</span> <span class="ow">in</span> <span class="n">loop_last</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
                        <span class="k">yield from</span> <span class="n">rendered_cell</span><span class="p">[</span><span class="n">line_no</span><span class="p">]</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_cell</span><span class="p">:</span>
                            <span class="k">yield</span> <span class="n">divider</span>
                    <span class="k">if</span> <span class="n">show_edge</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">right</span>
                    <span class="k">yield</span> <span class="n">new_line</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_height</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">rendered_cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">:</span>
                        <span class="k">yield from</span> <span class="n">rendered_cell</span><span class="p">[</span><span class="n">line_no</span><span class="p">]</span>
                    <span class="k">yield</span> <span class="n">new_line</span>
            <span class="k">if</span> <span class="n">_box</span> <span class="ow">and</span> <span class="n">first</span> <span class="ow">and</span> <span class="n">show_header</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">_Segment</span><span class="p">(</span>
                    <span class="n">_box</span><span class="o">.</span><span class="n">get_row</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="s2">&quot;head&quot;</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">show_edge</span><span class="p">),</span> <span class="n">border_style</span>
                <span class="p">)</span>
                <span class="k">yield</span> <span class="n">new_line</span>
            <span class="n">end_section</span> <span class="o">=</span> <span class="n">row</span> <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">end_section</span>
            <span class="k">if</span> <span class="n">_box</span> <span class="ow">and</span> <span class="p">(</span><span class="n">show_lines</span> <span class="ow">or</span> <span class="n">leading</span> <span class="ow">or</span> <span class="n">end_section</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">last</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">show_footer</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_cells</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">show_header</span> <span class="ow">and</span> <span class="n">header_row</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="n">leading</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">_Segment</span><span class="p">(</span>
                            <span class="n">_box</span><span class="o">.</span><span class="n">get_row</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="s2">&quot;mid&quot;</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">show_edge</span><span class="p">)</span> <span class="o">*</span> <span class="n">leading</span><span class="p">,</span>
                            <span class="n">border_style</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">_Segment</span><span class="p">(</span>
                            <span class="n">_box</span><span class="o">.</span><span class="n">get_row</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="s2">&quot;row&quot;</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">show_edge</span><span class="p">),</span> <span class="n">border_style</span>
                        <span class="p">)</span>
                    <span class="k">yield</span> <span class="n">new_line</span>

        <span class="k">if</span> <span class="n">_box</span> <span class="ow">and</span> <span class="n">show_edge</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">_Segment</span><span class="p">(</span><span class="n">_box</span><span class="o">.</span><span class="n">get_bottom</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">border_style</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">new_line</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
    <span class="kn">from</span> <span class="nn">rich.console</span> <span class="kn">import</span> <span class="n">Console</span>
    <span class="kn">from</span> <span class="nn">rich.highlighter</span> <span class="kn">import</span> <span class="n">ReprHighlighter</span>
    <span class="kn">from</span> <span class="nn">rich.table</span> <span class="kn">import</span> <span class="n">Table</span> <span class="k">as</span> <span class="n">Table</span>

    <span class="kn">from</span> <span class="nn">._timer</span> <span class="kn">import</span> <span class="n">timer</span>

    <span class="k">with</span> <span class="n">timer</span><span class="p">(</span><span class="s2">&quot;Table render&quot;</span><span class="p">):</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Star Wars Movies&quot;</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Rich example table&quot;</span><span class="p">,</span>
            <span class="n">caption_justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span>
            <span class="s2">&quot;Released&quot;</span><span class="p">,</span> <span class="n">header_style</span><span class="o">=</span><span class="s2">&quot;bright_cyan&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">no_wrap</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Box Office&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="s2">&quot;Dec 20, 2019&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Star Wars: The Rise of Skywalker&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$952,110,690&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;May 25, 2018&quot;</span><span class="p">,</span> <span class="s2">&quot;Solo: A Star Wars Story&quot;</span><span class="p">,</span> <span class="s2">&quot;$393,151,347&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="s2">&quot;Dec 15, 2017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Star Wars Ep. V111: The Last Jedi&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$1,332,539,889&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="s2">&quot;on black&quot;</span><span class="p">,</span>
            <span class="n">end_section</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="s2">&quot;Dec 16, 2016&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Rogue One: A Star Wars Story&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$1,332,439,889&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
            <span class="n">console</span><span class="o">.</span><span class="n">rule</span><span class="p">(</span><span class="n">highlight</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

        <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
        <span class="n">highlight</span> <span class="o">=</span> <span class="n">ReprHighlighter</span><span class="p">()</span>
        <span class="n">header</span><span class="p">(</span><span class="s2">&quot;Example Table&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">header</span><span class="p">(</span><span class="s2">&quot;expand=True&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">header</span><span class="p">(</span><span class="s2">&quot;width=50&quot;</span><span class="p">)</span>

        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">table</span><span class="o">.</span><span class="n">expand</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">table</span><span class="o">.</span><span class="n">row_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dim&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span>
        <span class="n">header</span><span class="p">(</span><span class="s2">&quot;row_styles=[&#39;dim&#39;, &#39;none&#39;]&quot;</span><span class="p">)</span>

        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">table</span><span class="o">.</span><span class="n">expand</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">table</span><span class="o">.</span><span class="n">row_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dim&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span>
        <span class="n">table</span><span class="o">.</span><span class="n">leading</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">header</span><span class="p">(</span><span class="s2">&quot;leading=1, row_styles=[&#39;dim&#39;, &#39;none&#39;]&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">table</span><span class="o">.</span><span class="n">expand</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">table</span><span class="o">.</span><span class="n">row_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dim&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span>
        <span class="n">table</span><span class="o">.</span><span class="n">show_lines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">table</span><span class="o">.</span><span class="n">leading</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">header</span><span class="p">(</span><span class="s2">&quot;show_lines=True, row_styles=[&#39;dim&#39;, &#39;none&#39;]&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2024, Oliver J. Backhouse.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>